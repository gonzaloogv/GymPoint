{
  "info": {
    "name": "GymPoint API - Colección Completa",
    "description": "Colección completa de endpoints del backend de GymPoint con tests automatizados",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "item": [
    {
      "name": "1. Health Checks",
      "item": [
        {
          "name": "Health Check (Liveness)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has status ok\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.eql('ok');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Verifica que el servidor esté corriendo (liveness probe)"
          }
        },
        {
          "name": "Ready Check (Readiness)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 503\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 503]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test(\"Database is connected\", function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData.database).to.eql('connected');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/ready",
              "host": ["{{base_url}}"],
              "path": ["ready"]
            },
            "description": "Verifica que el servidor esté listo (DB + migraciones OK)"
          }
        }
      ]
    },
    {
      "name": "2. Autenticación",
      "item": [
        {
          "name": "Registro de Usuario",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const user = pm.response.json();",
                  "    pm.environment.set('user_id', user.id_user);",
                  "    ",
                  "    pm.test(\"Usuario creado correctamente\", function () {",
                  "        pm.expect(user.email).to.be.a('string');",
                  "        pm.expect(user.auth_provider).to.eql('local');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Juan\",\n  \"lastname\": \"Pérez\",\n  \"email\": \"juan.perez@test.com\",\n  \"password\": \"password123\",\n  \"gender\": \"M\",\n  \"locality\": \"Resistencia\",\n  \"age\": 25,\n  \"role\": \"USER\",\n  \"frequency_goal\": 3\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "register"]
            },
            "description": "Crear una nueva cuenta de usuario local"
          }
        },
        {
          "name": "Login con Email y Password",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    ",
                  "    pm.environment.set('access_token', jsonData.accessToken);",
                  "    pm.environment.set('refresh_token', jsonData.refreshToken);",
                  "    pm.environment.set('user_id', jsonData.user.id_user);",
                  "    ",
                  "    pm.test(\"Login exitoso\", function () {",
                  "        pm.expect(jsonData.accessToken).to.be.a('string');",
                  "        pm.expect(jsonData.refreshToken).to.be.a('string');",
                  "        pm.expect(jsonData.user).to.have.property('id_user');",
                  "    });",
                  "    ",
                  "    console.log('✅ Tokens guardados en variables de entorno');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"juan.perez@test.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Iniciar sesión con credenciales locales"
          }
        },
        {
          "name": "Login con Google OAuth",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    ",
                  "    pm.environment.set('access_token', jsonData.accessToken);",
                  "    pm.environment.set('refresh_token', jsonData.refreshToken);",
                  "    pm.environment.set('user_id', jsonData.user.id_user);",
                  "    ",
                  "    pm.test(\"Google login exitoso\", function () {",
                  "        pm.expect(jsonData.user.auth_provider).to.eql('google');",
                  "        pm.expect(jsonData.user.google_id).to.be.a('string');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"idToken\": \"YOUR_GOOGLE_ID_TOKEN_HERE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/google",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "google"]
            },
            "description": "Iniciar sesión con Google OAuth2. Requiere un idToken válido de Google."
          }
        },
        {
          "name": "Refresh Access Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const jsonData = pm.response.json();",
                  "    pm.environment.set('access_token', jsonData.accessToken);",
                  "    ",
                  "    pm.test(\"Token refrescado correctamente\", function () {",
                  "        pm.expect(jsonData.accessToken).to.be.a('string');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{refresh_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/refresh-token",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "refresh-token"]
            },
            "description": "Obtener un nuevo access token usando el refresh token"
          }
        },
        {
          "name": "Logout",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Logout exitoso\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "// Limpiar tokens del entorno",
                  "pm.environment.unset('access_token');",
                  "pm.environment.unset('refresh_token');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{refresh_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/logout",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "logout"]
            },
            "description": "Cerrar sesión y revocar refresh token"
          }
        }
      ]
    },
    {
      "name": "3. Gimnasios",
      "item": [
        {
          "name": "Obtener Todos los Gimnasios",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is an array\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "    ",
                  "    if (jsonData.length > 0) {",
                  "        pm.environment.set('gym_id', jsonData[0].id_gym);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/gyms",
              "host": ["{{base_url}}"],
              "path": ["api", "gyms"]
            }
          }
        },
        {
          "name": "Buscar Gimnasios Cercanos",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Gimnasios tienen distancia calculada\", function () {",
                  "    const jsonData = pm.response.json();",
                  "    if (jsonData.length > 0) {",
                  "        pm.expect(jsonData[0]).to.have.property('distancia');",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/gyms/cercanos?lat=-27.4514&lon=-58.9867",
              "host": ["{{base_url}}"],
              "path": ["api", "gyms", "cercanos"],
              "query": [
                {
                  "key": "lat",
                  "value": "-27.4514"
                },
                {
                  "key": "lon",
                  "value": "-58.9867"
                }
              ]
            }
          }
        },
        {
          "name": "Obtener Gimnasio por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/gyms/{{gym_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "gyms", "{{gym_id}}"]
            }
          }
        },
        {
          "name": "Filtrar Gimnasios (PREMIUM)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/gyms/filtro?city=Resistencia&minPrice=10000&maxPrice=20000",
              "host": ["{{base_url}}"],
              "path": ["api", "gyms", "filtro"],
              "query": [
                {
                  "key": "city",
                  "value": "Resistencia"
                },
                {
                  "key": "minPrice",
                  "value": "10000"
                },
                {
                  "key": "maxPrice",
                  "value": "20000"
                }
              ]
            }
          }
        },
        {
          "name": "Crear Gimnasio (ADMIN)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"FitCenter Norte\",\n  \"description\": \"Gimnasio moderno con todas las comodidades\",\n  \"city\": \"Resistencia\",\n  \"address\": \"Av. 9 de Julio 5678\",\n  \"latitude\": -27.4444,\n  \"longitude\": -58.9999,\n  \"phone\": \"+54 362 4999999\",\n  \"email\": \"info@fitcenter.com\",\n  \"gym_type\": \"completo\",\n  \"equipment\": \"Pesas, Cardio, Funcional\",\n  \"month_price\": 18000,\n  \"week_price\": 6000\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/gyms",
              "host": ["{{base_url}}"],
              "path": ["api", "gyms"]
            }
          }
        }
      ]
    },
    {
      "name": "4. Asociación a Gimnasios",
      "item": [
        {
          "name": "Asociarse a un Gimnasio",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    pm.test(\"Asociación exitosa\", function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('id_gym');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id_user\": {{user_id}},\n  \"id_gym\": {{gym_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user-gym",
              "host": ["{{base_url}}"],
              "path": ["api", "user-gym"]
            }
          }
        },
        {
          "name": "Obtener Mis Gimnasios",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/user-gym/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "user-gym", "usuario", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "5. Asistencias",
      "item": [
        {
          "name": "Registrar Asistencia",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const jsonData = pm.response.json();",
                  "    ",
                  "    pm.test(\"Asistencia registrada\", function () {",
                  "        pm.expect(jsonData).to.have.property('asistencia');",
                  "        pm.expect(jsonData).to.have.property('tokens_actuales');",
                  "    });",
                  "    ",
                  "    pm.test(\"Se ganaron tokens\", function () {",
                  "        pm.expect(jsonData.tokens_actuales).to.be.above(0);",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id_user\": {{user_id}},\n  \"id_gym\": {{gym_id}},\n  \"latitude\": -27.4514,\n  \"longitude\": -58.9867\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/assistances/registrar",
              "host": ["{{base_url}}"],
              "path": ["api", "assistances", "registrar"]
            }
          }
        },
        {
          "name": "Obtener Historial de Asistencias",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/assistances/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "assistances", "usuario", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "6. Rutinas",
      "item": [
        {
          "name": "Crear Rutina con Ejercicios",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const routine = pm.response.json();",
                  "    pm.environment.set('routine_id', routine.id_routine);",
                  "    ",
                  "    pm.test(\"Rutina creada\", function () {",
                  "        pm.expect(routine).to.have.property('id_routine');",
                  "        pm.expect(routine.exercises.length).to.be.at.least(3);",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"routine_name\": \"Rutina de Fuerza\",\n  \"description\": \"Rutina enfocada en fuerza\",\n  \"exercises\": [\n    {\n      \"id_exercise\": 1,\n      \"series\": 4,\n      \"reps\": 10,\n      \"order\": 1\n    },\n    {\n      \"id_exercise\": 2,\n      \"series\": 3,\n      \"reps\": 12,\n      \"order\": 2\n    },\n    {\n      \"id_exercise\": 3,\n      \"series\": 4,\n      \"reps\": 8,\n      \"order\": 3\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/routines",
              "host": ["{{base_url}}"],
              "path": ["api", "routines"]
            }
          }
        },
        {
          "name": "Obtener Mis Rutinas",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/routines/me",
              "host": ["{{base_url}}"],
              "path": ["api", "routines", "me"]
            }
          }
        },
        {
          "name": "Completar Rutina",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    pm.test(\"Rutina completada\", function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('tokens_ganados');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id_user\": {{user_id}},\n  \"id_routine\": {{routine_id}},\n  \"completed\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user-routines",
              "host": ["{{base_url}}"],
              "path": ["api", "user-routines"]
            }
          }
        }
      ]
    },
    {
      "name": "7. Recompensas",
      "item": [
        {
          "name": "Obtener Todas las Recompensas",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const jsonData = pm.response.json();",
                  "if (jsonData.length > 0) {",
                  "    pm.environment.set('reward_id', jsonData[0].id_reward);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/rewards",
              "host": ["{{base_url}}"],
              "path": ["api", "rewards"]
            }
          }
        },
        {
          "name": "Canjear Recompensa",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.test(\"Recompensa canjeada\", function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('tokens_restantes');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id_user\": {{user_id}},\n  \"id_reward\": {{reward_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/rewards/canjear",
              "host": ["{{base_url}}"],
              "path": ["api", "rewards", "canjear"]
            }
          }
        },
        {
          "name": "Obtener Mis Recompensas Canjeadas",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/rewards/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "rewards", "usuario", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "8. Tokens y Transacciones",
      "item": [
        {
          "name": "Obtener Balance de Tokens",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/tokens/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "tokens", "usuario", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Obtener Historial de Transacciones",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/transactions/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "transactions", "usuario", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "9. Frecuencia y Progreso",
      "item": [
        {
          "name": "Obtener Frecuencia Semanal",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/frequency/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "frequency", "usuario", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Actualizar Meta Semanal",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"goal\": 4\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/frequency/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "frequency", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Obtener Progreso del Usuario",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/progress/usuario/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "progress", "usuario", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "10. Usuario",
      "item": [
        {
          "name": "Obtener Mi Perfil",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/users/me",
              "host": ["{{base_url}}"],
              "path": ["api", "users", "me"]
            }
          }
        },
        {
          "name": "Actualizar Perfil",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Juan Carlos\",\n  \"locality\": \"Corrientes\",\n  \"age\": 26\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "users", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Eliminar Mi Cuenta",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{access_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/users/me",
              "host": ["{{base_url}}"],
              "path": ["api", "users", "me"]
            }
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "test",
      "script": {
        "exec": [
          "// Tests globales para toda la colección",
          "",
          "pm.test(\"Status code is not 500\", function () {",
          "    pm.expect(pm.response.code).to.not.equal(500);",
          "});",
          "",
          "pm.test(\"Response time is less than 2000ms\", function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(2000);",
          "});",
          "",
          "// Verificar formato de error estándar",
          "if (pm.response.code >= 400) {",
          "    pm.test(\"Error has standard format\", function () {",
          "        const jsonData = pm.response.json();",
          "        pm.expect(jsonData).to.have.property('error');",
          "        if (jsonData.error) {",
          "            pm.expect(jsonData.error).to.have.property('code');",
          "            pm.expect(jsonData.error).to.have.property('message');",
          "        }",
          "    });",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "refresh_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "gym_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "routine_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "reward_id",
      "value": "1",
      "type": "string"
    }
  ]
}

