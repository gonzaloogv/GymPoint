openapi: 3.1.0
info:
  title: GymPoint API
  version: 1.0.0
  description: API del sistema GymPoint para gestión de gimnasios, rutinas, entrenamientos y gamificación.
servers:
  - url: http://localhost:3000
    description: Servidor de desarrollo local
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: Datos inválidos o request malformada
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Datos inválidos
    Unauthorized:
      description: Autenticación requerida o token inválido/expirado
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: No autenticado
    Forbidden:
      description: Permisos insuficientes para realizar la operación
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Acceso denegado
    NotFound:
      description: Recurso no encontrado
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Recurso no encontrado
    Conflict:
      description: Conflicto con el estado actual del recurso
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: El recurso ya existe
    InternalServerError:
      description: Error interno del servidor
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Error interno del servidor
  parameters:
    PageParam:
      name: page
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
      description: Número de página (1-indexado).
    LimitParam:
      name: limit
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
      description: Tamaño máximo de página.
    OrderParam:
      name: order
      in: query
      required: false
      schema:
        type: string
        enum:
          - asc
          - desc
        default: desc
      description: Dirección de ordenamiento.
    GymSortParam:
      name: sortBy
      in: query
      required: false
      schema:
        type: string
        enum:
          - created_at
          - name
          - city
          - month_price
        default: created_at
      description: Campo permitido para ordenar gimnasios.
    GymIdPathParam:
      name: gymId
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: Identificador del gimnasio (`id_gym`).
    IdPathParam:
      name: id
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: Identificador único del recurso
    UserIdPathParam:
      name: userId
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID del usuario
    ExerciseIdPathParam:
      name: id_exercise
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID del ejercicio
    RoutineIdPathParam:
      name: id_routine
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID de la rutina
    RoutineDayIdPathParam:
      name: id_routine_day
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID del día de rutina
    MediaIdPathParam:
      name: id_media
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID del elemento multimedia
    SessionIdPathParam:
      name: sessionId
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID de la sesión de entrenamiento
    SetIdPathParam:
      name: setId
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
      description: ID del set de ejercicio
    StatusQueryParam:
      name: status
      in: query
      required: false
      schema:
        type: string
      description: Filtrar por estado
    AvailableQueryParam:
      name: available
      in: query
      required: false
      schema:
        type: boolean
      description: Filtrar solo elementos disponibles
    ActiveQueryParam:
      name: active
      in: query
      required: false
      schema:
        type: boolean
      description: Filtrar solo elementos activos
    StartDateParam:
      name: startDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Fecha de inicio del rango (YYYY-MM-DD)
    EndDateParam:
      name: endDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Fecha de fin del rango (YYYY-MM-DD)
    SearchQueryParam:
      name: search
      in: query
      required: false
      schema:
        type: string
        minLength: 1
        maxLength: 255
      description: Término de búsqueda
    SortByParam:
      name: sortBy
      in: query
      required: false
      schema:
        type: string
      description: Campo por el cual ordenar
  schemas:
    PaginationMeta:
      type: object
      required:
        - page
        - limit
        - total
        - totalPages
      additionalProperties: false
      properties:
        page:
          type: integer
          minimum: 1
          description: Página actual
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          description: Elementos por página
          example: 10
        total:
          type: integer
          minimum: 0
          description: Total de elementos
          example: 42
        totalPages:
          type: integer
          minimum: 0
          description: Total de páginas
          example: 5
    SubscriptionType:
      type: string
      enum:
        - FREE
        - PREMIUM
      description: Tipo de suscripción del usuario
    Gender:
      type: string
      enum:
        - M
        - F
        - O
      description: Género del usuario (M=Masculino, F=Femenino, O=Otro)
    DifficultyLevel:
      type: string
      enum:
        - EASY
        - MEDIUM
        - HARD
      description: Nivel de dificultad estándar
    ExtendedDifficultyLevel:
      type: string
      enum:
        - EASY
        - MEDIUM
        - HARD
        - BEGINNER
        - INTERMEDIATE
        - ADVANCED
      description: Nivel de dificultad extendido
    WorkoutSessionStatus:
      type: string
      enum:
        - IN_PROGRESS
        - COMPLETED
        - CANCELLED
      description: Estado de una sesión de entrenamiento
    UserRoutineStatus:
      type: string
      enum:
        - ACTIVE
        - COMPLETED
        - CANCELLED
      description: Estado de una rutina de usuario
    AchievementCategory:
      type: string
      enum:
        - ONBOARDING
        - STREAK
        - FREQUENCY
        - ATTENDANCE
        - ROUTINE
        - CHALLENGE
        - PROGRESS
        - TOKEN
        - SOCIAL
      description: Categoría de logro
    MuscleGroup:
      type: string
      enum:
        - CHEST
        - BACK
        - LEGS
        - SHOULDERS
        - ARMS
        - ABS
        - FULL_BODY
      description: Grupo muscular objetivo
    ChallengeType:
      type: string
      enum:
        - STEPS
        - CALORIES
        - DURATION
        - REPS
        - DISTANCE
      description: Tipo de desafío
    ChallengeProgressStatus:
      type: string
      enum:
        - NOT_STARTED
        - IN_PROGRESS
        - COMPLETED
      description: Estado del progreso de desafío
    MediaType:
      type: string
      enum:
        - IMAGE
        - VIDEO
      description: Tipo de archivo multimedia
    EntityType:
      type: string
      enum:
        - USER_PROFILE
        - GYM
        - EXERCISE
        - PROGRESS
      description: Tipo de entidad asociada
    RewardCategory:
      type: string
      enum:
        - descuento
        - pase_gratis
        - producto
        - servicio
        - merchandising
      description: Categoría de recompensa
    PaymentStatus:
      type: string
      enum:
        - PENDING
        - COMPLETED
        - FAILED
        - REFUNDED
      description: Estado del pago
    AccountDeletionStatus:
      type: string
      enum:
        - PENDING
        - CANCELLED
        - COMPLETED
      description: Estado de solicitud de eliminación
    AchievementMetric:
      type: string
      enum:
        - STREAK_DAYS
        - STREAK_RECOVERY_USED
        - ASSISTANCE_TOTAL
        - FREQUENCY_WEEKS_MET
        - ROUTINE_COMPLETED_COUNT
        - CHALLENGE_COMPLETED_COUNT
        - TOKEN_EARNED_TOTAL
        - SOCIAL_SHARE_COUNT
      description: Métrica de logro
    ChallengeMetric:
      type: string
      enum:
        - MINUTES
        - EXERCISES
        - FREQUENCY
      description: Métrica de desafío
    Error:
      type: object
      required:
        - error
      additionalProperties: false
      properties:
        error:
          type: string
          description: Mensaje de error descriptivo
          example: Ha ocurrido un error
    AchievementDefinitionResponse:
      type: object
      required:
        - id_achievement_definition
        - code
        - name
        - category
        - metric_type
        - target_value
        - is_active
        - created_at
        - updated_at
      properties:
        id_achievement_definition:
          type: integer
          example: 1
        code:
          type: string
          description: Código único del achievement
          example: FIRST_CHECKIN
        name:
          type: string
          description: Nombre del achievement
          example: Primera Visita
        description:
          type:
            - string
            - 'null'
          description: Descripción del achievement
          example: Completaste tu primera visita al gimnasio
        category:
          $ref: '#/components/schemas/AchievementCategory'
          example: ONBOARDING
        metric_type:
          type: string
          enum:
            - STREAK_DAYS
            - STREAK_RECOVERY_USED
            - ASSISTANCE_TOTAL
            - FREQUENCY_WEEKS_MET
            - ROUTINE_COMPLETED_COUNT
            - WORKOUT_SESSION_COMPLETED
            - DAILY_CHALLENGE_COMPLETED_COUNT
            - PR_RECORD_COUNT
            - BODY_WEIGHT_PROGRESS
            - TOKEN_BALANCE_REACHED
            - TOKEN_SPENT_TOTAL
            - ONBOARDING_STEP_COMPLETED
          example: ASSISTANCE_TOTAL
        target_value:
          type: number
          minimum: 0
          example: 1
        metadata:
          type:
            - object
            - 'null'
          description: Metadatos adicionales del achievement
          properties:
            token_reward:
              type: integer
            unlock_message:
              type: string
            icon:
              type: string
        icon_url:
          type:
            - string
            - 'null'
          example: https://cdn.gympoint.app/icons/first-checkin.png
        is_active:
          type: boolean
          default: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    CreateAchievementDefinitionRequest:
      type: object
      additionalProperties: false
      required:
        - code
        - name
        - category
        - metric_type
        - target_value
      properties:
        code:
          type: string
          minLength: 1
          maxLength: 100
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        category:
          $ref: '#/components/schemas/AchievementCategory'
        metric_type:
          type: string
          enum:
            - STREAK_DAYS
            - STREAK_RECOVERY_USED
            - ASSISTANCE_TOTAL
            - FREQUENCY_WEEKS_MET
            - ROUTINE_COMPLETED_COUNT
            - WORKOUT_SESSION_COMPLETED
            - DAILY_CHALLENGE_COMPLETED_COUNT
            - PR_RECORD_COUNT
            - BODY_WEIGHT_PROGRESS
            - TOKEN_BALANCE_REACHED
            - TOKEN_SPENT_TOTAL
            - ONBOARDING_STEP_COMPLETED
        target_value:
          type: number
          minimum: 0
        metadata:
          type: object
        icon_url:
          type: string
        is_active:
          type: boolean
          default: true
    UpdateAchievementDefinitionRequest:
      type: object
      additionalProperties: false
      properties:
        code:
          type: string
          minLength: 1
          maxLength: 100
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        category:
          $ref: '#/components/schemas/AchievementCategory'
        metric_type:
          type: string
          enum:
            - STREAK_DAYS
            - STREAK_RECOVERY_USED
            - ASSISTANCE_TOTAL
            - FREQUENCY_WEEKS_MET
            - ROUTINE_COMPLETED_COUNT
            - WORKOUT_SESSION_COMPLETED
            - DAILY_CHALLENGE_COMPLETED_COUNT
            - PR_RECORD_COUNT
            - BODY_WEIGHT_PROGRESS
            - TOKEN_BALANCE_REACHED
            - TOKEN_SPENT_TOTAL
            - ONBOARDING_STEP_COMPLETED
        target_value:
          type: number
          minimum: 0
        metadata:
          type: object
        icon_url:
          type: string
        is_active:
          type: boolean
    AuthSuccessResponse:
      type: object
      required:
        - tokens
        - user
      properties:
        tokens:
          $ref: '#/components/schemas/AuthTokenPair'
        user:
          $ref: '#/components/schemas/AuthUser'
    AuthTokenPair:
      type: object
      required:
        - accessToken
        - refreshToken
      additionalProperties: false
      properties:
        accessToken:
          type: string
          description: JWT con vigencia corta (15 minutos).
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refreshToken:
          type: string
          description: Token de renovación con vigencia de 30 días.
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    AuthUser:
      type: object
      required:
        - id_account
        - email
        - email_verified
        - roles
        - profile
      additionalProperties: false
      properties:
        id_account:
          type: integer
        email:
          type: string
          format: email
        email_verified:
          type: boolean
        roles:
          type: array
          minItems: 1
          items:
            type: string
            example: USER
        profile:
          $ref: '#/components/schemas/UserProfileSummary'
    RegisterRequest:
      type: object
      additionalProperties: false
      required:
        - email
        - password
        - name
        - lastname
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
          maxLength: 64
        name:
          type: string
          minLength: 2
          maxLength: 80
        lastname:
          type: string
          minLength: 2
          maxLength: 80
        gender:
          allOf:
            - $ref: '#/components/schemas/Gender'
          default: O
        locality:
          type: string
          maxLength: 120
        birth_date:
          type:
            - string
            - 'null'
          format: date
        frequency_goal:
          type: integer
          minimum: 1
          maximum: 14
          default: 3
    LoginRequest:
      type: object
      additionalProperties: false
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
          maxLength: 64
    GoogleLoginRequest:
      type: object
      additionalProperties: false
      required:
        - idToken
      properties:
        idToken:
          type: string
          description: ID token emitido por Google Sign-In.
    RefreshTokenRequest:
      type: object
      additionalProperties: false
      required:
        - refreshToken
      properties:
        refreshToken:
          type: string
          description: Token de renovación vigente.
    RefreshTokenResponse:
      type: object
      additionalProperties: false
      required:
        - accessToken
      properties:
        accessToken:
          type: string
          description: Nuevo JWT de acceso.
    LogoutRequest:
      type: object
      additionalProperties: false
      required:
        - refreshToken
      properties:
        refreshToken:
          type: string
          description: Refresh token a revocar.
    UpdateTokensRequest:
      type: object
      required:
        - delta
      additionalProperties: false
      properties:
        delta:
          type: integer
          description: Cantidad a incrementar (positivo) o decrementar (negativo)
          example: 50
        reason:
          type: string
          maxLength: 255
          description: Razón del ajuste de tokens
          example: Recompensa por evento especial
    TokensUpdateResponse:
      type: object
      required:
        - id_user_profile
        - new_balance
        - delta
      additionalProperties: false
      properties:
        id_user_profile:
          type: integer
          description: ID del perfil de usuario
        new_balance:
          type: integer
          minimum: 0
          description: Nuevo balance de tokens
          example: 200
        delta:
          type: integer
          description: Cantidad ajustada
          example: 50
    RegisterWorkoutSetRequest:
      type: object
      additionalProperties: false
      properties:
        id_exercise:
          type: integer
        weight:
          type: number
        reps:
          type: integer
        rpe:
          type: integer
        rest_seconds:
          type: integer
        is_warmup:
          type: boolean
        notes:
          type: string
        performed_at:
          type: string
          format: date-time
      required:
        - id_exercise
    TodayChallengeResponse:
      type: object
      additionalProperties: false
      properties:
        challenge:
          type: object
          properties:
            id_challenge:
              type: integer
            challenge_date:
              type: string
              format: date
            title:
              type: string
            description:
              type: string
            challenge_type:
              $ref: '#/components/schemas/ChallengeType'
            target_value:
              type: integer
            target_unit:
              type: string
            tokens_reward:
              type: integer
            difficulty:
              $ref: '#/components/schemas/DifficultyLevel'
            is_active:
              type: boolean
        progress:
          type: object
          properties:
            id_user_challenge:
              type: integer
            id_user_profile:
              type: integer
            id_challenge:
              type: integer
            current_value:
              type: integer
            status:
              $ref: '#/components/schemas/ChallengeProgressStatus'
            completed_at:
              type: string
              format: date-time
            reward_claimed_at:
              type: string
              format: date-time
    ChallengeProgressResponse:
      type: object
      required:
        - progress
        - completed
        - tokens_earned
      additionalProperties: false
      properties:
        progress:
          type: integer
          description: Valor actual del progreso
        completed:
          type: boolean
          description: Si el desafío fue completado
        tokens_earned:
          type: integer
          description: Tokens otorgados (si se completó)
    DailyChallengeTemplateResponse:
      type: object
      required:
        - id_template
        - title
        - challenge_type
        - target_value
        - tokens_reward
        - difficulty
        - rotation_weight
        - is_active
        - created_at
        - updated_at
      properties:
        id_template:
          type: integer
          example: 1
        title:
          type: string
          example: Entrena 30 minutos
        description:
          type:
            - string
            - 'null'
          example: Completa al menos 30 minutos de ejercicio
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
          example: MINUTES
        target_value:
          type: number
          minimum: 0
          example: 30
        target_unit:
          type:
            - string
            - 'null'
          example: minutos
        tokens_reward:
          type: integer
          minimum: 0
          default: 10
          example: 15
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
          example: EASY
        rotation_weight:
          type: number
          minimum: 0
          default: 1
          description: Peso para la rotación automática (mayor = más frecuente)
          example: 1.5
        is_active:
          type: boolean
          default: true
        created_by:
          type:
            - integer
            - 'null'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    CreateDailyChallengeTemplateRequest:
      type: object
      additionalProperties: false
      required:
        - title
        - challenge_type
        - target_value
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
        target_value:
          type: number
          minimum: 0
        target_unit:
          type: string
        tokens_reward:
          type: integer
          minimum: 0
          default: 10
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
          default: MEDIUM
        rotation_weight:
          type: number
          minimum: 0
          default: 1
        is_active:
          type: boolean
          default: true
    UpdateDailyChallengeTemplateRequest:
      type: object
      additionalProperties: false
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
        target_value:
          type: number
          minimum: 0
        target_unit:
          type: string
        tokens_reward:
          type: integer
          minimum: 0
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
        rotation_weight:
          type: number
          minimum: 0
        is_active:
          type: boolean
    DailyChallengeResponse:
      type: object
      required:
        - id_challenge
        - challenge_date
        - title
        - challenge_type
        - target_value
        - tokens_reward
        - difficulty
        - is_active
        - created_at
        - updated_at
      properties:
        id_challenge:
          type: integer
          example: 1
        challenge_date:
          type: string
          format: date
          example: '2025-10-23'
        title:
          type: string
          example: Entrena 30 minutos
        description:
          type:
            - string
            - 'null'
          example: Completa al menos 30 minutos de ejercicio hoy
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
          example: MINUTES
        target_value:
          type: number
          minimum: 0
          example: 30
        target_unit:
          type:
            - string
            - 'null'
          example: minutos
        tokens_reward:
          type: integer
          minimum: 0
          default: 10
          example: 15
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
          example: EASY
        is_active:
          type: boolean
          default: true
        id_template:
          type:
            - integer
            - 'null'
          description: ID de la plantilla usada (si aplica)
        auto_generated:
          type: boolean
          default: false
        created_by:
          type:
            - integer
            - 'null'
          description: ID del admin que lo creó
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    CreateDailyChallengeRequest:
      type: object
      additionalProperties: false
      required:
        - challenge_date
        - title
        - challenge_type
        - target_value
      properties:
        challenge_date:
          type: string
          format: date
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
        target_value:
          type: number
          minimum: 0
        target_unit:
          type: string
        tokens_reward:
          type: integer
          minimum: 0
          default: 10
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
          default: MEDIUM
        is_active:
          type: boolean
          default: true
        id_template:
          type: integer
        auto_generated:
          type: boolean
          default: false
    UpdateDailyChallengeRequest:
      type: object
      additionalProperties: false
      properties:
        challenge_date:
          type: string
          format: date
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
        challenge_type:
          type: string
          enum:
            - MINUTES
            - EXERCISES
            - FREQUENCY
        target_value:
          type: number
          minimum: 0
        target_unit:
          type: string
        tokens_reward:
          type: integer
          minimum: 0
        difficulty:
          $ref: '#/components/schemas/ExtendedDifficultyLevel'
        is_active:
          type: boolean
        id_template:
          type: integer
        auto_generated:
          type: boolean
    Exercise:
      type: object
      properties:
        id_exercise:
          type: integer
        exercise_name:
          type: string
        muscular_group:
          type: string
        description:
          type: string
        equipment_needed:
          type: string
        difficulty:
          type: string
          enum:
            - beginner
            - intermediate
            - advanced
        instructions:
          type: string
        video_url:
          type: string
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id_exercise
        - exercise_name
    CreateExerciseRequest:
      type: object
      additionalProperties: false
      properties:
        exercise_name:
          type: string
        muscular_group:
          type: string
        description:
          type: string
        equipment_needed:
          type: string
        difficulty:
          type: string
          enum:
            - beginner
            - intermediate
            - advanced
        instructions:
          type: string
        video_url:
          type: string
      required:
        - exercise_name
    UpdateExerciseRequest:
      type: object
      additionalProperties: false
      properties:
        exercise_name:
          type: string
        muscular_group:
          type: string
        description:
          type: string
        equipment_needed:
          type: string
        difficulty:
          type: string
          enum:
            - beginner
            - intermediate
            - advanced
        instructions:
          type: string
        video_url:
          type: string
    PaginatedExercisesResponse:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - items
          additionalProperties: false
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/Exercise'
    RoutineExercise:
      type: object
      properties:
        id_routine:
          type: integer
        id_exercise:
          type: integer
        id_routine_day:
          type: integer
        series:
          type: integer
        reps:
          type: string
        order:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id_routine
        - id_exercise
        - series
        - reps
        - order
    ExerciseInRoutine:
      type: object
      properties:
        id_exercise:
          type: integer
        exercise_name:
          type: string
        muscular_group:
          type: string
        series:
          type: integer
        reps:
          type: string
        order:
          type: integer
        id_routine_day:
          type: integer
    AddExerciseToRoutineRequest:
      type: object
      additionalProperties: false
      properties:
        id_exercise:
          type: integer
        series:
          type: integer
        reps:
          type: string
        order:
          type: integer
        id_routine_day:
          type: integer
      required:
        - id_exercise
        - series
        - reps
        - order
    UpdateRoutineExerciseRequest:
      type: object
      additionalProperties: false
      properties:
        series:
          type: integer
        reps:
          type: string
        order:
          type: integer
        id_routine_day:
          type: integer
    FrequencyResponse:
      type: object
      additionalProperties: false
      properties:
        id_frequency:
          type: integer
        id_user_profile:
          type: integer
        goal:
          type: integer
          description: Meta semanal de asistencias
        assist:
          type: integer
          description: Asistencias realizadas en la semana actual
        achieved_goal:
          type: boolean
          description: Si alcanzó la meta esta semana
        week_start_date:
          type: string
          format: date
          description: Fecha de inicio de semana ISO (Lunes)
        week_number:
          type: integer
          description: Número de semana ISO
        year:
          type: integer
          description: Año de la semana
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    GymRequest:
      type: object
      properties:
        id_gym_request:
          type: integer
        name:
          type: string
        description:
          type:
            - string
            - 'null'
        city:
          type: string
        address:
          type: string
        status:
          type: string
          enum:
            - pending
            - approved
            - rejected
        created_at:
          type: string
    CreateGymRequestDTO:
      type: object
      required:
        - name
        - location
        - contact
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
        description:
          type: string
          maxLength: 2000
        location:
          type: object
          required:
            - city
            - address
          properties:
            city:
              type: string
              maxLength: 50
            address:
              type: string
              maxLength: 200
            latitude:
              type: number
              minimum: -90
              maximum: 90
            longitude:
              type: number
              minimum: -180
              maximum: 180
        contact:
          type: object
          properties:
            phone:
              type: string
              maxLength: 20
            email:
              oneOf:
                - type: string
                  format: email
                - type: string
                  maxLength: 0
            social_media:
              type: object
              properties:
                instagram:
                  type: string
                  maxLength: 100
                facebook:
                  type: string
                  maxLength: 100
        website:
          type: string
          format: uri
        attributes:
          type: object
          properties:
            photos:
              type: array
              items:
                type: string
                format: uri
            equipment:
              type: object
              description: Equipamiento categorizado por tipo con cantidades
              additionalProperties:
                type: array
                items:
                  type: object
                  required:
                    - name
                    - quantity
                  properties:
                    name:
                      type: string
                    quantity:
                      type: integer
                      minimum: 1
              example:
                fuerza:
                  - name: Banco press
                    quantity: 4
                cardio:
                  - name: Cinta
                    quantity: 8
            services:
              type: array
              items:
                type: string
              description: Servicios/tipos del gimnasio
              example:
                - Funcional
                - CrossFit
            rules:
              type: array
              items:
                type: string
              description: Reglas del gimnasio
        pricing:
          type: object
          properties:
            monthly:
              type: number
              minimum: 0
            weekly:
              type: number
              minimum: 0
            daily:
              type: number
              minimum: 0
        schedule:
          type: array
          items:
            type: object
        amenities:
          type: array
          items:
            type: string
    GymSpecialScheduleResponse:
      type: object
      required:
        - id_special_schedule
        - id_gym
        - date
        - closed
        - motive
        - created_at
        - updated_at
      properties:
        id_special_schedule:
          type: integer
          example: 1
        id_gym:
          type: integer
          example: 5
        date:
          type: string
          format: date
          description: Fecha del horario especial
          example: '2025-12-25'
        opening_time:
          type:
            - string
            - 'null'
          format: time
          description: Hora de apertura (HH:MM)
          example: '10:00'
        closing_time:
          type:
            - string
            - 'null'
          format: time
          description: Hora de cierre (HH:MM)
          example: '14:00'
        closed:
          type: boolean
          description: Si el gimnasio está cerrado todo el día
          default: false
        motive:
          type: string
          description: Motivo del horario especial
          example: Feriado Nacional - Navidad
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    CreateGymSpecialScheduleRequest:
      type: object
      additionalProperties: false
      required:
        - id_gym
        - date
        - closed
        - motive
      properties:
        id_gym:
          type: integer
          minimum: 1
        date:
          type: string
          format: date
        opening_time:
          type: string
          format: time
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
        closing_time:
          type: string
          format: time
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
        closed:
          type: boolean
        motive:
          type: string
          minLength: 1
          maxLength: 500
    UpdateGymSpecialScheduleRequest:
      type: object
      additionalProperties: false
      properties:
        id_gym:
          type: integer
          minimum: 1
        date:
          type: string
          format: date
        opening_time:
          type: string
          format: time
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
        closing_time:
          type: string
          format: time
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
        closed:
          type: boolean
        motive:
          type: string
          minLength: 1
          maxLength: 500
    GymListResponse:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - items
          additionalProperties: false
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/GymResponse'
    GymResponse:
      type: object
      required:
        - id_gym
        - name
        - city
        - address
        - latitude
        - longitude
        - month_price
        - geofence_radius_meters
        - min_stay_minutes
        - created_at
        - updated_at
      properties:
        id_gym:
          type: integer
        name:
          type: string
          maxLength: 120
        description:
          type:
            - string
            - 'null'
        phone:
          type:
            - string
            - 'null'
        email:
          type:
            - string
            - 'null'
        website:
          type:
            - string
            - 'null'
        is_active:
          type:
            - boolean
            - 'null'
        verified:
          type:
            - boolean
            - 'null'
        featured:
          type:
            - boolean
            - 'null'
        auto_checkin_enabled:
          type:
            - boolean
            - 'null'
        city:
          type: string
        address:
          type: string
        latitude:
          type: number
          format: double
        longitude:
          type: number
          format: double
        month_price:
          type: number
          format: float
          minimum: 0
        week_price:
          type:
            - number
            - 'null'
          format: float
          minimum: 0
        geofence_radius_meters:
          type: integer
          minimum: 10
          maximum: 2000
        min_stay_minutes:
          type: integer
          minimum: 5
          maximum: 240
        is_favorite:
          type:
            - boolean
            - 'null'
        is_subscribed:
          type:
            - boolean
            - 'null'
        distance:
          type:
            - number
            - 'null'
          format: float
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        whatsapp:
          type:
            - string
            - 'null'
          maxLength: 40
          description: Número de WhatsApp
        instagram:
          type:
            - string
            - 'null'
          maxLength: 100
          description: Usuario de Instagram
        facebook:
          type:
            - string
            - 'null'
          maxLength: 200
          description: URL de Facebook
        google_maps_url:
          type:
            - string
            - 'null'
          description: URL de Google Maps
        photo_url:
          type:
            - string
            - 'null'
          description: URL de la foto principal del gimnasio
        logo_url:
          type:
            - string
            - 'null'
          maxLength: 500
          description: URL del logo del gimnasio
        registration_date:
          type:
            - string
            - 'null'
          format: date-time
          description: Fecha de registro del gimnasio en la plataforma
        social_media:
          type:
            - object
            - 'null'
          description: Redes sociales del gimnasio (objeto JSON)
          additionalProperties: true
        services:
          type:
            - array
            - 'null'
          items:
            type: string
          description: 'Servicios/tipos del gimnasio (ej: ["Funcional", "CrossFit", "Musculación"])'
          example:
            - Funcional
            - CrossFit
            - Musculación
        equipment:
          type:
            - object
            - 'null'
          description: 'Equipamiento categorizado por tipo con cantidades (ej: { "fuerza": [{ "name": "Banco press", "quantity": 4 }] })'
          additionalProperties:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                  description: Nombre del equipo
                quantity:
                  type: integer
                  minimum: 1
                  description: Cantidad disponible
          example:
            fuerza:
              - name: Banco press
                quantity: 4
              - name: Rack sentadillas
                quantity: 2
            cardio:
              - name: Cinta de correr
                quantity: 8
        max_capacity:
          type:
            - integer
            - 'null'
          minimum: 1
          description: Capacidad máxima de personas
        area_sqm:
          type:
            - number
            - 'null'
          format: float
          minimum: 0
          description: Área en metros cuadrados
        rules:
          type:
            - array
            - 'null'
          items:
            type: string
          description: Reglas del gimnasio
        amenities:
          type:
            - array
            - 'null'
          items:
            type: object
            properties:
              id_amenity:
                type: integer
              name:
                type: string
              category:
                type:
                  - string
                  - 'null'
              icon_name:
                type:
                  - string
                  - 'null'
              created_at:
                type:
                  - string
                  - 'null'
                format: date-time
              updated_at:
                type:
                  - string
                  - 'null'
                format: date-time
          description: Amenidades del gimnasio (desde gym_amenity a través de gym_gym_amenity)
        deleted_at:
          type:
            - string
            - 'null'
          format: date-time
          description: Fecha de eliminación (soft delete)
    CreateGymRequest:
      type: object
      additionalProperties: false
      required:
        - name
        - city
        - address
        - latitude
        - longitude
        - month_price
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 120
        description:
          type: string
          maxLength: 2000
        city:
          type: string
          maxLength: 80
        address:
          type: string
          maxLength: 200
        latitude:
          type: number
          minimum: -90
          maximum: 90
        longitude:
          type: number
          minimum: -180
          maximum: 180
        phone:
          type: string
          maxLength: 40
        email:
          type: string
          format: email
        website:
          type: string
          format: uri
        social_media:
          type: object
          description: Redes sociales del gimnasio (objeto JSON)
          additionalProperties: true
        month_price:
          type: number
          minimum: 0
        week_price:
          type: number
          minimum: 0
        geofence_radius_meters:
          type: integer
          minimum: 10
          maximum: 2000
          default: 100
        min_stay_minutes:
          type: integer
          minimum: 5
          maximum: 240
          default: 30
        whatsapp:
          type: string
          maxLength: 40
          description: Número de WhatsApp
        instagram:
          type: string
          maxLength: 100
          description: Usuario de Instagram
        facebook:
          type: string
          maxLength: 200
          description: URL de Facebook
        google_maps_url:
          type: string
          maxLength: 500
          description: URL de Google Maps
        logo_url:
          type: string
          maxLength: 500
          description: URL del logo
        photo_url:
          type: string
          maxLength: 500
          description: URL de la foto principal
        equipment:
          type: object
          description: Equipamiento categorizado por tipo con cantidades
          additionalProperties:
            type: array
            items:
              type: object
              required:
                - name
                - quantity
              properties:
                name:
                  type: string
                  description: Nombre del equipo
                quantity:
                  type: integer
                  minimum: 1
                  description: Cantidad disponible
          example:
            fuerza:
              - name: Banco press
                quantity: 4
            cardio:
              - name: Cinta de correr
                quantity: 8
        services:
          type: array
          items:
            type: string
          description: 'Servicios/tipos del gimnasio (ej: ["Funcional", "CrossFit"])'
          example:
            - Funcional
            - CrossFit
            - Musculación
        max_capacity:
          type: integer
          minimum: 1
          description: Capacidad máxima
        area_sqm:
          type: number
          minimum: 0
          description: Área en metros cuadrados
        verified:
          type: boolean
          description: Gimnasio verificado
        featured:
          type: boolean
          description: Gimnasio destacado
        auto_checkin_enabled:
          type: boolean
          default: true
          description: Auto check-in habilitado
        amenities:
          type: array
          items:
            type: integer
            minimum: 1
        rules:
          type: array
          items:
            type: string
    UpdateGymRequest:
      allOf:
        - $ref: '#/components/schemas/CreateGymRequest'
    GymAmenity:
      type: object
      required:
        - id_amenity
        - name
      properties:
        id_amenity:
          type: integer
        name:
          type: string
        category:
          type:
            - string
            - 'null'
    CreateGymScheduleRequest:
      type: object
      required:
        - day_of_week
        - open_time
        - close_time
      additionalProperties: false
      properties:
        day_of_week:
          type: integer
          minimum: 0
          maximum: 6
          description: Día de la semana (0=Domingo, 1=Lunes, ..., 6=Sábado)
          example: 1
        open_time:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$
          description: Hora de apertura (HH:MM o HH:MM:SS)
          example: '06:00'
        close_time:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$
          description: Hora de cierre (HH:MM o HH:MM:SS)
          example: '22:00'
        is_closed:
          type: boolean
          default: false
          description: Si el gimnasio está cerrado ese día
    UpdateGymScheduleRequest:
      type: object
      additionalProperties: false
      properties:
        open_time:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$
          description: Hora de apertura (HH:MM o HH:MM:SS)
          example: '06:00'
        close_time:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$
          description: Hora de cierre (HH:MM o HH:MM:SS)
          example: '22:00'
        is_closed:
          type: boolean
          description: Si el gimnasio está cerrado ese día
    GymScheduleResponse:
      type: object
      required:
        - id_schedule
        - id_gym
        - day_of_week
        - open_time
        - close_time
        - is_closed
      additionalProperties: false
      properties:
        id_schedule:
          type: integer
          description: ID del horario
        id_gym:
          type: integer
          description: ID del gimnasio
        day_of_week:
          type: integer
          minimum: 0
          maximum: 6
          description: Día de la semana
        open_time:
          type: string
          description: Hora de apertura
          example: '06:00:00'
        close_time:
          type: string
          description: Hora de cierre
          example: '22:00:00'
        is_closed:
          type: boolean
          description: Si está cerrado
    GymSchedulesWeekResponse:
      type: object
      description: Horarios de la semana (0=Domingo a 6=Sábado)
      additionalProperties: false
      properties:
        '0':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '1':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '2':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '3':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '4':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '5':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
        '6':
          oneOf:
            - $ref: '#/components/schemas/GymScheduleResponse'
            - type: 'null'
    CreateGymReviewRequest:
      type: object
      required:
        - rating
      additionalProperties: false
      properties:
        rating:
          type: number
          format: float
          minimum: 1
          maximum: 5
          description: Rating general del gimnasio
          example: 4.5
        title:
          type: string
          maxLength: 100
          description: Título de la reseña
          example: Excelente gimnasio
        comment:
          type: string
          maxLength: 1000
          description: Comentario detallado
          example: Muy buenas instalaciones y personal amable
        cleanliness_rating:
          type: integer
          minimum: 1
          maximum: 5
          description: Rating de limpieza
        equipment_rating:
          type: integer
          minimum: 1
          maximum: 5
          description: Rating de equipamiento
        staff_rating:
          type: integer
          minimum: 1
          maximum: 5
          description: Rating del personal
        facilities_rating:
          type: integer
          minimum: 1
          maximum: 5
          description: Rating de instalaciones
        value_rating:
          type: integer
          minimum: 1
          maximum: 5
          description: Rating de relación calidad-precio
    GymReviewResponse:
      type: object
      required:
        - id_review
        - id_gym
        - id_user_profile
        - rating
        - created_at
        - updated_at
      additionalProperties: false
      properties:
        id_review:
          type: integer
          description: ID de la reseña
        id_gym:
          type: integer
          description: ID del gimnasio
        id_user_profile:
          type: integer
          description: ID del usuario autor
        rating:
          type: number
          format: float
          description: Rating general
        title:
          type: string
          description: Título
        comment:
          type: string
          description: Comentario
        cleanliness_rating:
          type: integer
        equipment_rating:
          type: integer
        staff_rating:
          type: integer
        facilities_rating:
          type: integer
        value_rating:
          type: integer
        helpful_count:
          type: integer
          description: Votos útiles
          default: 0
        not_helpful_count:
          type: integer
          description: Votos no útiles
          default: 0
        user:
          type: object
          description: Info del usuario autor
          properties:
            id_user_profile:
              type: integer
            name:
              type: string
            profile_picture_url:
              type: string
        user_voted:
          type: boolean
          description: Si el usuario actual votó útil
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PaginatedGymReviewsResponse:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - items
          additionalProperties: false
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/GymReviewResponse'
    CreateGymPaymentRequest:
      type: object
      required:
        - amount
      additionalProperties: false
      properties:
        amount:
          type: number
          format: float
          minimum: 0.01
          description: Monto del pago
          example: 1500
        payment_method:
          type: string
          maxLength: 50
          description: Método de pago
          example: efectivo
        payment_date:
          type: string
          format: date-time
          description: Fecha del pago
        period_start:
          type: string
          format: date
          description: Inicio del período pagado
        period_end:
          type: string
          format: date
          description: Fin del período pagado
        reference_number:
          type: string
          maxLength: 100
          description: Número de referencia
        notes:
          type: string
          maxLength: 500
          description: Notas adicionales
    GymPaymentResponse:
      type: object
      required:
        - id_payment
        - id_user_profile
        - id_gym
        - amount
        - payment_date
        - status
        - created_at
      additionalProperties: false
      properties:
        id_payment:
          type: integer
          description: ID del pago
        id_user_profile:
          type: integer
          description: ID del usuario
        id_gym:
          type: integer
          description: ID del gimnasio
        amount:
          type: number
          format: float
          description: Monto pagado
        payment_method:
          type: string
          description: Método de pago
        payment_date:
          type: string
          format: date-time
          description: Fecha del pago
        period_start:
          type: string
          format: date
          description: Inicio del período
        period_end:
          type: string
          format: date
          description: Fin del período
        status:
          $ref: '#/components/schemas/PaymentStatus'
          description: Estado del pago
        reference_number:
          type: string
          description: Número de referencia
        notes:
          type: string
          description: Notas
        gym:
          type: object
          description: Info del gimnasio
          properties:
            id_gym:
              type: integer
            name:
              type: string
            city:
              type: string
        user:
          type: object
          description: Info del usuario
          properties:
            id_user_profile:
              type: integer
            name:
              type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PaginatedGymPaymentsResponse:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - items
          additionalProperties: false
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/GymPaymentResponse'
    MediaResponse:
      type: object
      properties:
        id_media:
          type: integer
          description: ID del archivo multimedia
          example: 1
        entity_type:
          $ref: '#/components/schemas/EntityType'
          description: Tipo de entidad asociada
          example: GYM
        entity_id:
          type: integer
          description: ID de la entidad asociada
          example: 5
        media_type:
          allOf:
            - $ref: '#/components/schemas/MediaType'
          description: Tipo de archivo
          example: IMAGE
        url:
          type: string
          format: uri
          description: URL del archivo
          example: https://example.com/gym.jpg
        thumbnail_url:
          type: string
          format: uri
          description: URL de la miniatura
          example: https://example.com/gym-thumb.jpg
        file_size:
          type: integer
          description: Tamaño del archivo en bytes
          example: 1024000
        mime_type:
          type: string
          description: Tipo MIME del archivo
          example: image/jpeg
        width:
          type: integer
          description: Ancho de la imagen en píxeles
          example: 1920
        height:
          type: integer
          description: Alto de la imagen en píxeles
          example: 1080
        is_primary:
          type: boolean
          description: Si es el archivo principal de la entidad
          example: true
          default: false
        display_order:
          type: integer
          description: Orden de visualización
          example: 0
          default: 0
        uploaded_at:
          type: string
          format: date-time
          description: Fecha de carga
        created_at:
          type: string
          format: date-time
          description: Fecha de creación
        updated_at:
          type: string
          format: date-time
          description: Fecha de última actualización
    ProgressResponse:
      type: object
      properties:
        id_progress:
          type: integer
          description: ID del registro de progreso
          example: 1
        id_user_profile:
          type: integer
          description: ID del perfil de usuario
          example: 10
        date:
          type: string
          format: date
          description: Fecha del registro
          example: '2025-01-15'
        total_weight_lifted:
          type: number
          format: float
          description: Peso total levantado en kg
          example: 5000
        total_reps:
          type: integer
          description: Repeticiones totales
          example: 100
        total_sets:
          type: integer
          description: Sets totales
          example: 20
        notes:
          type: string
          description: Notas adicionales
          example: Great workout session
        created_at:
          type: string
          format: date-time
          description: Fecha de creación
        updated_at:
          type: string
          format: date-time
          description: Fecha de última actualización
    CheckInRequest:
      type: object
      additionalProperties: false
      required:
        - id_gym
        - latitude
        - longitude
      properties:
        id_gym:
          type: integer
          minimum: 1
          description: ID del gimnasio
          example: 3
        latitude:
          type: number
          format: float
          minimum: -90
          maximum: 90
          description: Latitud actual del usuario
          example: -34.603722
        longitude:
          type: number
          format: float
          minimum: -180
          maximum: 180
          description: Longitud actual del usuario
          example: -58.38159
        accuracy:
          type: number
          format: float
          minimum: 0
          description: Precisión GPS en metros (opcional)
          example: 10.5
    AssistanceResponse:
      type: object
      properties:
        id_assistance:
          type: integer
          description: ID único de la asistencia
          example: 42
        id_user_profile:
          type: integer
          description: ID del perfil de usuario
          example: 5
        id_gym:
          type: integer
          description: ID del gimnasio
          example: 3
        date:
          type: string
          format: date
          description: Fecha de la asistencia
          example: '2025-10-23'
        check_in_time:
          type: string
          format: time
          description: Hora de check-in
          example: '14:30:00'
        check_out_time:
          type:
            - string
            - 'null'
          format: time
          description: Hora de check-out (si existe)
          example: '16:00:00'
        duration_minutes:
          type:
            - integer
            - 'null'
          description: Duración en minutos
          example: 90
        auto_checkin:
          type: boolean
          description: Si fue auto check-in por geofence
          example: false
          default: false
        distance_meters:
          type:
            - number
            - 'null'
          format: float
          description: Distancia en metros al momento del check-in
          example: 6.5
        verified:
          type: boolean
          description: Si la asistencia fue verificada
          example: true
          default: false
        created_at:
          type: string
          format: date-time
          description: Fecha de creación del registro
          example: '2025-10-23T14:30:00.000Z'
    CheckInResponseData:
      type: object
      properties:
        asistencia:
          $ref: '#/components/schemas/AssistanceResponse'
        distancia:
          type: integer
          description: Distancia en metros desde el gimnasio
          example: 6
        tokens_actuales:
          type: integer
          description: Tokens totales del usuario tras registrar asistencia
          example: 30
        racha_actual:
          type: integer
          description: Valor actual de la racha
          example: 5
    CheckOutResponse:
      type: object
      properties:
        asistencia:
          $ref: '#/components/schemas/AssistanceResponse'
        duration_minutes:
          type: integer
          description: Duración total de la sesión en minutos
          example: 90
        tokens_awarded:
          type: integer
          description: Tokens otorgados por duración
          example: 5
        tokens_total:
          type: integer
          description: Total de tokens del usuario
          example: 35
    PresenceRequest:
      type: object
      additionalProperties: false
      required:
        - id_gym
        - latitude
        - longitude
      properties:
        id_gym:
          type: integer
          minimum: 1
          description: ID del gimnasio
          example: 3
        latitude:
          type: number
          format: float
          minimum: -90
          maximum: 90
          description: Latitud actual del usuario
          example: -34.603722
        longitude:
          type: number
          format: float
          minimum: -180
          maximum: 180
          description: Longitud actual del usuario
          example: -58.38159
        accuracy:
          type: number
          format: float
          minimum: 0
          description: Precisión GPS en metros (opcional)
          example: 10.5
    PresenceResponse:
      type: object
      properties:
        duracion_minutos:
          type: integer
          description: Minutos de permanencia en el gimnasio
          example: 5
        min_stay_minutes:
          type: integer
          description: Tiempo mínimo requerido de permanencia
          example: 10
        listo_para_checkin:
          type: boolean
          description: Si cumplió el tiempo mínimo para auto check-in
          example: false
        progreso:
          type: string
          description: Progreso en formato texto
          example: 5/10 min
    AssistanceHistoryResponse:
      type: object
      properties:
        message:
          type: string
          example: Historial de asistencias obtenido con éxito
        data:
          type: array
          items:
            type: object
            properties:
              id_assistance:
                type: integer
                example: 42
              id_user_profile:
                type: integer
                example: 5
              id_gym:
                type: integer
                example: 3
              date:
                type: string
                format: date
                example: '2025-10-04'
              check_in_time:
                type: string
                format: time
                example: '14:30:00'
              check_out_time:
                type:
                  - string
                  - 'null'
                format: time
                example: '16:00:00'
              gym:
                type: object
                properties:
                  name:
                    type: string
                    example: MegaGym Centro
                  city:
                    type: string
                    example: Córdoba
                  address:
                    type: string
                    example: Av. Colón 123
    RewardResponse:
      type: object
      required:
        - id_reward
        - routine_name
        - description
        - token_cost
        - created_at
        - updated_at
      properties:
        id_reward:
          type: integer
          description: ID único de la recompensa
          example: 1
        id_gym:
          type:
            - integer
            - 'null'
          description: ID del gimnasio (null para recompensas globales)
        name:
          type: string
          description: Nombre de la recompensa
          example: Pase VIP 1 mes
        description:
          type: string
          description: Descripción detallada
          example: Acceso VIP durante 1 mes a todos los gimnasios
        reward_type:
          type:
            - string
            - 'null'
          enum:
            - descuento
            - pase_gratis
            - producto
            - servicio
            - merchandising
            - otro
            - null
          description: Tipo de recompensa
          example: pase_gratis
        token_cost:
          type: integer
          description: Costo en tokens
          minimum: 0
          example: 500
        discount_percentage:
          type:
            - number
            - 'null'
          minimum: 0
          maximum: 100
        discount_amount:
          type:
            - number
            - 'null'
          minimum: 0
        stock:
          type:
            - integer
            - 'null'
          description: Stock disponible
          minimum: 0
          example: 10
        valid_from:
          type:
            - string
            - 'null'
          format: date
          description: Fecha de inicio de validez
          example: '2025-01-01'
        valid_until:
          type:
            - string
            - 'null'
          format: date
          description: Fecha de fin de validez
          example: '2025-12-31'
        is_active:
          type: boolean
          description: Si está activa para canje
          default: true
        image_url:
          type:
            - string
            - 'null'
          maxLength: 500
          description: URL de la imagen de la recompensa
          example: https://cdn.gympoint.com/rewards/vip-pass.jpg
        terms:
          type:
            - string
            - 'null'
          description: Términos y condiciones de la recompensa
          example: Válido solo en horarios de 6am a 10pm. No acumulable con otras promociones.
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        deleted_at:
          type:
            - string
            - 'null'
          format: date-time
    CreateRewardRequest:
      type: object
      additionalProperties: true
      required:
        - name
        - description
        - token_cost
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          minLength: 1
        reward_type:
          type: string
          enum:
            - descuento
            - pase_gratis
            - producto
            - servicio
            - merchandising
            - otro
        token_cost:
          type: integer
          minimum: 0
        discount_percentage:
          type: number
          minimum: 0
          maximum: 100
        discount_amount:
          type: number
          minimum: 0
        stock:
          type: integer
          minimum: 0
        valid_from:
          type: string
          format: date
        valid_until:
          type: string
          format: date
        is_active:
          type: boolean
          default: true
        image_url:
          type: string
        terms:
          type: string
    UpdateRewardRequest:
      type: object
      additionalProperties: true
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          minLength: 1
        reward_type:
          type: string
          enum:
            - descuento
            - pase_gratis
            - producto
            - servicio
            - merchandising
            - otro
        token_cost:
          type: integer
          minimum: 0
        discount_percentage:
          type: number
          minimum: 0
          maximum: 100
        discount_amount:
          type: number
          minimum: 0
        stock:
          type: integer
          minimum: 0
        valid_from:
          type: string
          format: date
        valid_until:
          type: string
          format: date
        is_active:
          type: boolean
        image_url:
          type: string
        terms:
          type: string
    PaginatedRewardsResponse:
      type: object
      required:
        - items
        - page
        - limit
        - total
        - totalPages
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/RewardResponse'
        page:
          type: integer
          minimum: 1
        limit:
          type: integer
          minimum: 1
        total:
          type: integer
          minimum: 0
        totalPages:
          type: integer
          minimum: 0
    Routine:
      type: object
      properties:
        id_routine:
          type: integer
        routine_name:
          type: string
        description:
          type: string
        created_by:
          type: integer
        is_template:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id_routine
        - routine_name
    RoutineWithDetails:
      allOf:
        - $ref: '#/components/schemas/Routine'
        - type: object
          properties:
            creator:
              type: object
              properties:
                id_user_profile:
                  type: integer
                name:
                  type: string
                lastname:
                  type: string
            days:
              type: array
              items:
                $ref: '#/components/schemas/RoutineDay'
            exercises:
              type: array
              items:
                $ref: '#/components/schemas/ExerciseInRoutine'
    RoutineDay:
      type: object
      properties:
        id_routine_day:
          type: integer
        id_routine:
          type: integer
        day_number:
          type: integer
        title:
          type: string
        description:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id_routine_day
        - id_routine
        - day_number
    CreateRoutineRequest:
      type: object
      additionalProperties: false
      properties:
        routine_name:
          type: string
        description:
          type: string
        exercises:
          type: array
          items:
            type: object
            properties:
              id_exercise:
                type: integer
              series:
                type: integer
              reps:
                type: string
              order:
                type: integer
              day_number:
                type: integer
            required:
              - id_exercise
              - series
              - reps
              - order
          minItems: 2
        days:
          type: array
          items:
            type: object
            properties:
              day_number:
                type: integer
              title:
                type: string
              description:
                type: string
            required:
              - day_number
      required:
        - routine_name
        - exercises
    UpdateRoutineRequest:
      type: object
      additionalProperties: false
      properties:
        routine_name:
          type: string
        description:
          type: string
    CreateRoutineDayRequest:
      type: object
      additionalProperties: false
      properties:
        day_number:
          type: integer
        title:
          type: string
        description:
          type: string
      required:
        - day_number
    UpdateRoutineDayRequest:
      type: object
      additionalProperties: false
      properties:
        day_number:
          type: integer
        title:
          type: string
        description:
          type: string
    PaginatedRoutinesResponse:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - items
          additionalProperties: false
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/Routine'
    AssignRoutineRequest:
      type: object
      additionalProperties: false
      properties:
        id_routine:
          type: integer
        start_date:
          type: string
          format: date-time
      required:
        - id_routine
    ImportRoutineRequest:
      type: object
      additionalProperties: false
      properties:
        id_template_routine:
          type: integer
      required:
        - id_template_routine
    StreakResponse:
      type: object
      additionalProperties: false
      properties:
        id_streak:
          type: integer
        id_user_profile:
          type: integer
        value:
          type: integer
          description: Días consecutivos de racha actual
        last_value:
          type: integer
          description: Última racha antes de perderla
        max_value:
          type: integer
          description: Racha máxima alcanzada
        recovery_items:
          type: integer
          description: Items de recuperación disponibles
        last_assistance_date:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        userProfile:
          type: object
          properties:
            id_user_profile:
              type: integer
            name:
              type: string
            lastname:
              type: string
        frequency:
          type: object
          properties:
            goal:
              type: integer
            assist:
              type: integer
            achieved_goal:
              type: boolean
    StreakStatsResponse:
      type: object
      additionalProperties: false
      properties:
        totalStreaks:
          type: integer
          description: Total de rachas en el sistema
        averageStreak:
          type: integer
          description: Promedio de días de racha
        maxStreak:
          type: integer
          description: Racha máxima registrada
    UserRoutine:
      type: object
      properties:
        id_user_routine:
          type: integer
        id_user:
          type: integer
        id_routine:
          type: integer
        start_date:
          type: string
          format: date-time
        finish_date:
          type: string
          format: date-time
        active:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        routine:
          $ref: '#/components/schemas/RoutineWithDetails'
      required:
        - id_user_routine
        - id_user
        - id_routine
        - start_date
        - active
    UserRoutineCounts:
      type: object
      properties:
        total_owned:
          type: integer
        imported_count:
          type: integer
        created_count:
          type: integer
    UserProfileSummary:
      type: object
      required:
        - id_user_profile
        - name
        - lastname
        - subscription
      additionalProperties: false
      properties:
        id_user_profile:
          type: integer
        name:
          type: string
          example: Ana
        lastname:
          type: string
          example: Torres
        subscription:
          $ref: '#/components/schemas/SubscriptionType'
          description: Nivel actual de la app.
        premium_since:
          type:
            - string
            - 'null'
          format: date-time
        tokens_balance:
          type: integer
          minimum: 0
        tokens_lifetime:
          type: integer
          minimum: 0
        locality:
          type:
            - string
            - 'null'
        gender:
          oneOf:
            - $ref: '#/components/schemas/Gender'
            - type: 'null'
        birth_date:
          type:
            - string
            - 'null'
          format: date
    UserProfileResponse:
      type: object
      required:
        - id_user_profile
        - email
        - name
        - lastname
        - subscription
        - tokens
        - created_at
      additionalProperties: false
      properties:
        id_user_profile:
          type: integer
          description: ID único del perfil de usuario
          example: 42
        email:
          type: string
          format: email
          description: Email del usuario
          example: usuario@example.com
        name:
          type: string
          minLength: 2
          maxLength: 80
          description: Nombre del usuario
          example: Juan
        lastname:
          type: string
          minLength: 2
          maxLength: 80
          description: Apellido del usuario
          example: Pérez
        gender:
          oneOf:
            - $ref: '#/components/schemas/Gender'
            - type: 'null'
          description: Género del usuario
          example: M
        birth_date:
          oneOf:
            - type: string
              format: date
            - type: 'null'
          description: Fecha de nacimiento (YYYY-MM-DD)
          example: '1990-05-15'
        locality:
          oneOf:
            - type: string
            - type: 'null'
          description: Localidad del usuario
          example: Buenos Aires
        profile_picture_url:
          oneOf:
            - type: string
              format: uri
            - type: 'null'
          description: URL de la foto de perfil
        subscription:
          allOf:
            - $ref: '#/components/schemas/SubscriptionType'
          description: Nivel de suscripción actual
          example: FREE
        tokens:
          type: integer
          minimum: 0
          description: Balance actual de tokens
          example: 150
        preferred_language:
          type: string
          description: Idioma preferido (código ISO 639-1)
          example: es
        timezone:
          oneOf:
            - type: string
            - type: 'null'
          description: Zona horaria del usuario
          example: America/Argentina/Buenos_Aires
        onboarding_completed:
          type: boolean
          description: Indica si completó el onboarding
          example: true
        created_at:
          type: string
          format: date-time
          description: Fecha de creación del perfil
        updated_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de última actualización
    UpdateUserProfileRequest:
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 80
          description: Nombre del usuario
        lastname:
          type: string
          minLength: 2
          maxLength: 80
          description: Apellido del usuario
        gender:
          $ref: '#/components/schemas/Gender'
        birth_date:
          type: string
          format: date
          description: Fecha de nacimiento (YYYY-MM-DD)
          example: '1990-05-15'
        locality:
          type: string
          maxLength: 100
          description: Localidad del usuario
        profile_picture_url:
          type: string
          format: uri
          description: URL de la foto de perfil
        preferred_language:
          type: string
          pattern: ^[a-z]{2}$
          description: Idioma preferido (código ISO 639-1)
          example: es
        timezone:
          type: string
          description: Zona horaria del usuario
          example: America/Argentina/Buenos_Aires
        onboarding_completed:
          type: boolean
          description: Marca el onboarding como completado
    UpdateEmailRequest:
      type: object
      required:
        - email
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          description: Nuevo email del usuario
          example: nuevo@example.com
    EmailUpdateResponse:
      type: object
      required:
        - email
        - email_verified
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          description: Email actualizado
        email_verified:
          type: boolean
          description: Estado de verificación del email
          example: false
        message:
          type: string
          description: Mensaje informativo
          example: Email actualizado. Por favor verifica tu nuevo email.
    RequestAccountDeletionRequest:
      type: object
      additionalProperties: false
      properties:
        reason:
          type: string
          maxLength: 500
          description: Razón de la eliminación (opcional)
          example: Ya no uso la aplicación
    AccountDeletionResponse:
      type: object
      required:
        - status
        - scheduled_deletion_date
      additionalProperties: false
      properties:
        id_account_deletion_request:
          type: integer
          description: ID de la solicitud de eliminación
        id_account:
          type: integer
          description: ID de la cuenta
        status:
          type: string
          enum:
            - PENDING
            - CANCELLED
            - COMPLETED
          description: Estado de la solicitud
          example: PENDING
        reason:
          oneOf:
            - type: string
            - type: 'null'
          description: Razón proporcionada por el usuario
        scheduled_deletion_date:
          type: string
          format: date-time
          description: Fecha programada para eliminación
        cancelled_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de cancelación (si aplica)
        metadata:
          type: object
          description: Metadatos adicionales de la solicitud
          properties:
            grace_period_days:
              type: integer
              description: Días de período de gracia
              example: 30
    AccountDeletionStatusResponse:
      type: object
      required:
        - has_active_request
      additionalProperties: false
      properties:
        has_active_request:
          type: boolean
          description: Indica si hay una solicitud activa
          example: true
        request:
          oneOf:
            - $ref: '#/components/schemas/AccountDeletionResponse'
            - type: 'null'
          description: Detalles de la solicitud (si existe)
    NotificationSettingsResponse:
      type: object
      required:
        - id_user_notification_setting
        - id_user_profile
        - push_enabled
        - email_enabled
      additionalProperties: false
      properties:
        id_user_notification_setting:
          type: integer
          description: ID único de la configuración
        id_user_profile:
          type: integer
          description: ID del perfil de usuario
        push_enabled:
          type: boolean
          description: Notificaciones push habilitadas
          example: true
        email_enabled:
          type: boolean
          description: Notificaciones por email habilitadas
          example: true
        reminder_enabled:
          type: boolean
          description: Recordatorios habilitados
          example: true
        achievement_enabled:
          type: boolean
          description: Notificaciones de logros habilitadas
          example: true
        reward_enabled:
          type: boolean
          description: Notificaciones de recompensas habilitadas
          example: true
        gym_news_enabled:
          type: boolean
          description: Novedades de gimnasios habilitadas
          example: false
        quiet_hours_start:
          oneOf:
            - type: string
              pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
            - type: 'null'
          description: Inicio de horario silencioso (HH:MM)
          example: '22:00'
        quiet_hours_end:
          oneOf:
            - type: string
              pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
            - type: 'null'
          description: Fin de horario silencioso (HH:MM)
          example: '08:00'
        created_at:
          type: string
          format: date-time
          description: Fecha de creación
        updated_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de última actualización
    UpdateNotificationSettingsRequest:
      type: object
      additionalProperties: false
      properties:
        push_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones push
        email_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones por email
        reminder_enabled:
          type: boolean
          description: Habilitar/deshabilitar recordatorios
        achievement_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones de logros
        reward_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones de recompensas
        gym_news_enabled:
          type: boolean
          description: Habilitar/deshabilitar novedades de gimnasios
        quiet_hours_start:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
          description: Inicio de horario silencioso (HH:MM)
          example: '22:00'
        quiet_hours_end:
          type: string
          pattern: ^([0-1][0-9]|2[0-3]):[0-5][0-9]$
          description: Fin de horario silencioso (HH:MM)
          example: '08:00'
    UpdateSubscriptionRequest:
      type: object
      required:
        - subscription
      additionalProperties: false
      properties:
        subscription:
          type: string
          enum:
            - FREE
            - PREMIUM
          description: Nuevo nivel de suscripción
          example: PREMIUM
    WorkoutSession:
      type: object
      properties:
        id_workout_session:
          type: integer
        id_user_profile:
          type: integer
        id_routine:
          type: integer
        id_routine_day:
          type: integer
        status:
          $ref: '#/components/schemas/WorkoutSessionStatus'
        started_at:
          type: string
          format: date-time
        finished_at:
          type: string
          format: date-time
        duration_seconds:
          type: integer
        total_sets:
          type: integer
        total_reps:
          type: integer
        total_weight:
          type: number
        notes:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        routine:
          type: object
          properties:
            id_routine:
              type: integer
            routine_name:
              type: string
        routine_day:
          type: object
          properties:
            id_routine_day:
              type: integer
            day_number:
              type: integer
            title:
              type: string
        sets:
          type: array
          items:
            $ref: '#/components/schemas/WorkoutSet'
      required:
        - id_workout_session
        - id_user_profile
        - status
        - started_at
    StartWorkoutSessionRequest:
      type: object
      additionalProperties: false
      properties:
        id_routine:
          type: integer
        id_routine_day:
          type: integer
        started_at:
          type: string
          format: date-time
        notes:
          type: string
    UpdateWorkoutSetRequest:
      type: object
      additionalProperties: false
      properties:
        weight:
          type: number
        reps:
          type: integer
        rpe:
          type: integer
        rest_seconds:
          type: integer
        is_warmup:
          type: boolean
        notes:
          type: string
    WorkoutSet:
      type: object
      properties:
        id_workout_set:
          type: integer
        id_workout_session:
          type: integer
        id_exercise:
          type: integer
        set_number:
          type: integer
        weight:
          type: number
        reps:
          type: integer
        rpe:
          type: integer
        rest_seconds:
          type: integer
        is_warmup:
          type: boolean
        notes:
          type: string
        performed_at:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        exercise:
          type: object
          properties:
            id_exercise:
              type: integer
            exercise_name:
              type: string
            muscular_group:
              type: string
      required:
        - id_workout_set
        - id_workout_session
        - id_exercise
        - set_number
    WorkoutStats:
      type: object
      properties:
        total_workouts:
          type: integer
        total_sets:
          type: integer
        total_reps:
          type: integer
        total_weight:
          type: number
    CompleteWorkoutSessionRequest:
      type: object
      additionalProperties: false
      properties:
        ended_at:
          type: string
          format: date-time
        notes:
          type: string
    UpdateWorkoutSessionRequest:
      type: object
      additionalProperties: false
      properties:
        notes:
          type: string
paths:
  /api/achievements/definitions:
    get:
      operationId: listAchievementDefinitions
      tags:
        - Achievements
      summary: Listar todas las definiciones de logros
      description: Obtiene la lista de todas las definiciones de achievements (alias de /api/achievements)
      security:
        - BearerAuth: []
      parameters:
        - name: category
          in: query
          required: false
          schema:
            type: string
            enum:
              - ONBOARDING
              - STREAK
              - FREQUENCY
              - ATTENDANCE
              - ROUTINE
              - CHALLENGE
              - PROGRESS
              - TOKEN
              - SOCIAL
          description: Filtrar por categoría
        - name: includeInactive
          in: query
          required: false
          schema:
            type: boolean
          description: Incluir achievements inactivos
      responses:
        '200':
          description: Lista de definiciones de logros
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AchievementDefinitionResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createAchievementDefinition
      tags:
        - Achievements
      summary: Crear una nueva definición de logro
      description: Crea una nueva definición de achievement (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAchievementDefinitionRequest'
      responses:
        '201':
          description: Achievement creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AchievementDefinitionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/achievements/definitions/{id}:
    get:
      operationId: getAchievementDefinitionById
      tags:
        - Achievements
      summary: Obtener un logro por ID
      description: Obtiene los detalles de una definición de achievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del achievement
      responses:
        '200':
          description: Detalles del achievement
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AchievementDefinitionResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateAchievementDefinition
      tags:
        - Achievements
      summary: Actualizar una definición de logro
      description: Actualiza los datos de un achievement (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del achievement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAchievementDefinitionRequest'
      responses:
        '200':
          description: Achievement actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AchievementDefinitionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteAchievementDefinition
      tags:
        - Achievements
      summary: Eliminar un logro
      description: Elimina lógicamente un achievement (soft delete)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del achievement
      responses:
        '204':
          description: Achievement eliminado exitosamente
        '404':
          $ref: '#/components/responses/NotFound'
  /api/achievements/me:
    get:
      operationId: getMyAchievements
      tags:
        - Achievements
      summary: Listar los logros del usuario autenticado
      description: Obtiene la lista de achievements del usuario con su progreso actual
      security:
        - BearerAuth: []
      parameters:
        - name: category
          in: query
          required: false
          schema:
            type: string
            enum:
              - ONBOARDING
              - STREAK
              - FREQUENCY
              - ATTENDANCE
              - ROUTINE
              - CHALLENGE
              - PROGRESS
              - TOKEN
              - SOCIAL
          description: Filtrar por categoría
      responses:
        '200':
          description: Lista de logros del usuario con progreso
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        code:
                          type: string
                        name:
                          type: string
                        description:
                          type: string
                        category:
                          type: string
                        metric_type:
                          type: string
                        target_value:
                          type: number
                        icon_url:
                          type: string
                        is_active:
                          type: boolean
                        metadata:
                          type: object
                        progress:
                          type: number
                        unlocked:
                          type: boolean
                        unlocked_at:
                          type: string
                          format: date-time
                        last_source_type:
                          type: string
                        last_source_id:
                          type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/achievements/sync:
    post:
      operationId: syncMyAchievements
      tags:
        - Achievements
      summary: Recalcular los logros del usuario
      description: Sincroniza y recalcula todos los achievements del usuario autenticado
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                category:
                  type: string
                  description: Si se especifica, recalcula solo esa categoría
      responses:
        '200':
          description: Logros sincronizados exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      type: object
                  unlocked:
                    type: array
                    items:
                      type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/admin/stats:
    get:
      operationId: getAdminStats
      summary: Obtener estadísticas generales del sistema
      description: Devuelve estadísticas del sistema (usuarios, gimnasios, etc.)
      tags:
        - Admin
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Estadísticas obtenidas correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_users:
                    type: integer
                  total_gyms:
                    type: integer
                  total_workouts:
                    type: integer
                  active_subscriptions:
                    type: integer
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/me:
    get:
      operationId: getAdminProfile
      summary: Obtener perfil del admin actual
      description: Devuelve la información del administrador autenticado
      tags:
        - Admin
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Perfil del admin
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_admin_profile:
                    type: integer
                  id_account:
                    type: integer
                  email:
                    type: string
                  name:
                    type: string
                  lastname:
                    type: string
                  department:
                    type:
                      - string
                      - 'null'
                  notes:
                    type:
                      - string
                      - 'null'
                  created_at:
                    type: string
                    format: date-time
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/activity:
    get:
      operationId: getAdminActivity
      summary: Obtener actividad reciente del sistema
      description: Devuelve actividad reciente (últimos N días)
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: days
          in: query
          description: Número de días de actividad (default 7)
          required: false
          schema:
            type: integer
            default: 7
      responses:
        '200':
          description: Actividad reciente
          content:
            application/json:
              schema:
                type: object
                properties:
                  registrations:
                    type: array
                    items:
                      type: object
                  workouts:
                    type: array
                    items:
                      type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/users:
    get:
      operationId: listAdminUsers
      summary: Listar todos los usuarios
      description: Lista paginada de usuarios con filtros
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: subscription
          in: query
          description: Filtrar por tipo de suscripción
          required: false
          schema:
            type: string
            enum:
              - FREE
              - PREMIUM
        - name: search
          in: query
          description: Buscar por email o nombre
          required: false
          schema:
            type: string
        - name: sortBy
          in: query
          description: Campo para ordenar
          required: false
          schema:
            type: string
        - name: order
          in: query
          description: Orden ascendente o descendente
          required: false
          schema:
            type: string
            enum:
              - ASC
              - DESC
      responses:
        '200':
          description: Lista de usuarios
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/users/search:
    get:
      operationId: searchAdminUser
      summary: Buscar usuario por email
      description: Busca un usuario específico por su email
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: email
          in: query
          description: Email del usuario a buscar
          required: true
          schema:
            type: string
            format: email
      responses:
        '200':
          description: Usuario encontrado
          content:
            application/json:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/admin/users/{id}/tokens:
    post:
      operationId: grantUserTokens
      summary: Otorgar tokens a un usuario
      description: Añade o resta tokens del balance de un usuario
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID del usuario
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - delta
              properties:
                delta:
                  type: integer
                  description: Cantidad de tokens (positivo para añadir, negativo para restar)
                reason:
                  type: string
                  description: Razón del ajuste
      responses:
        '200':
          description: Tokens otorgados correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_user_profile:
                    type: integer
                  new_balance:
                    type: integer
                  delta:
                    type: integer
                  reason:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/admin/users/{id}/subscription:
    put:
      operationId: adminUpdateUserSubscription
      summary: Actualizar suscripción de usuario
      description: Cambia el tipo de suscripción de un usuario
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID del usuario
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - subscription
              properties:
                subscription:
                  type: string
                  enum:
                    - FREE
                    - PREMIUM
      responses:
        '200':
          description: Suscripción actualizada
          content:
            application/json:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/admin/users/{id}/deactivate:
    post:
      operationId: deactivateUser
      summary: Desactivar cuenta de usuario
      description: Desactiva la cuenta de un usuario
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID del usuario
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Usuario desactivado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  id_account:
                    type: integer
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/admin/users/{id}/activate:
    post:
      operationId: activateUser
      summary: Activar cuenta de usuario
      description: Activa la cuenta de un usuario previamente desactivado
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID del usuario
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Usuario activado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  id_account:
                    type: integer
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/admin/transactions:
    get:
      operationId: getAdminTransactions
      summary: Obtener log de transacciones de tokens
      description: Lista paginada de transacciones de tokens
      tags:
        - Admin
      security:
        - BearerAuth: []
      parameters:
        - name: user_id
          in: query
          description: Filtrar por ID de usuario
          required: false
          schema:
            type: integer
        - name: page
          in: query
          description: Número de página
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Elementos por página
          required: false
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: Lista de transacciones
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                  pagination:
                    type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/assistances:
    post:
      operationId: registrarAsistencia
      summary: Registrar check-in en un gimnasio
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
                - latitude
                - longitude
              properties:
                id_gym:
                  type: integer
                  description: ID del gimnasio
                  example: 3
                latitude:
                  type: number
                  format: float
                  description: Latitud actual del usuario
                  example: -34.603722
                longitude:
                  type: number
                  format: float
                  description: Longitud actual del usuario
                  example: -58.38159
                accuracy:
                  type: number
                  format: float
                  description: Precisión del GPS en metros
                  example: 10.5
      responses:
        '201':
          description: Asistencia registrada con éxito
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Asistencia registrada con éxito
                  data:
                    type: object
                    properties:
                      id_assistance:
                        type: integer
                      id_user_profile:
                        type: integer
                      id_gym:
                        type: integer
                      entry_time:
                        type: string
                        format: date-time
                      latitude:
                        type: number
                      longitude:
                        type: number
                      accuracy:
                        type: number
                      gym:
                        type: object
                        properties:
                          id_gym:
                            type: integer
                          name:
                            type: string
                          address:
                            type: string
                          city:
                            type: string
        '400':
          description: Error en validación o fuera de rango
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        enum:
                          - OUT_OF_RANGE
                          - GPS_INACCURATE
                          - SUBSCRIPTION_REQUIRED
                          - ASSISTANCE_REGISTRATION_FAILED
                          - MISSING_FIELDS
                      message:
                        type: string
        '401':
          description: No autorizado
        '403':
          description: Requiere rol de usuario app
  /api/assistances/me:
    get:
      operationId: obtenerHistorialAsistencias
      summary: Obtener historial de asistencias del usuario
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Historial obtenido con éxito
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id_assistance:
                          type: integer
                        id_user_profile:
                          type: integer
                        id_gym:
                          type: integer
                        entry_time:
                          type: string
                          format: date-time
                        exit_time:
                          type: string
                          format: date-time
                          nullable: true
                        latitude:
                          type: number
                        longitude:
                          type: number
                        accuracy:
                          type: number
                          nullable: true
                        duration_minutes:
                          type: integer
                          nullable: true
                        created_at:
                          type: string
                          format: date-time
                        updated_at:
                          type: string
                          format: date-time
                        gym:
                          type: object
                          properties:
                            id_gym:
                              type: integer
                            name:
                              type: string
                            address:
                              type: string
                            city:
                              type: string
                            profile_image_url:
                              type: string
                              nullable: true
        '400':
          description: Error al obtener historial
        '401':
          description: No autorizado
  /api/assistances/auto-checkin:
    post:
      operationId: autoCheckIn
      summary: Auto check-in del usuario (usa geofence)
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
                - latitude
                - longitude
              properties:
                id_gym:
                  type: integer
                latitude:
                  type: number
                longitude:
                  type: number
      responses:
        '201':
          description: Auto check-in registrado
        '400':
          description: Error de validación
  /api/assistances/{id}/checkout:
    put:
      operationId: checkOut
      summary: Registrar check-out y bonus por duración
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID de la asistencia
      responses:
        '200':
          description: Check-out registrado
        '400':
          description: Error de validación
  /api/assistances/presence:
    post:
      operationId: registrarPresencia
      summary: Registrar presencia del usuario (PREMIUM)
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
                - latitude
                - longitude
              properties:
                id_gym:
                  type: integer
                latitude:
                  type: number
                longitude:
                  type: number
      responses:
        '200':
          description: Presencia actualizada
        '403':
          description: Función exclusiva premium
  /api/assistances/today-status:
    get:
      operationId: verificarCheckInHoy
      summary: Verificar si el usuario ya hizo check-in hoy
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Estado de check-in del día
          content:
            application/json:
              schema:
                type: object
                properties:
                  has_checked_in_today:
                    type: boolean
                    example: true
                  assistance:
                    type: object
                    nullable: true
                    properties:
                      id_assistance:
                        type: integer
                      id_gym:
                        type: integer
                      entry_time:
                        type: string
                        format: date-time
                      gym_name:
                        type: string
        '401':
          description: No autorizado
  /api/assistances/verify-auto-checkin:
    post:
      operationId: verificarAutoCheckIn
      summary: Verificar y registrar auto check-in (PREMIUM)
      tags:
        - Asistencias
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
              properties:
                id_gym:
                  type: integer
      responses:
        '201':
          description: Auto check-in completado
        '400':
          description: No cumple permanencia mínima
        '403':
          description: Función exclusiva premium
  /api/auth/register:
    post:
      operationId: registerAccount
      tags:
        - Auth
      summary: Registrar una nueva cuenta de usuario
      description: |
        Crea una `Account`, `UserProfile`, `Frequency` y `Streak` iniciales. Retorna los tokens de autenticación y la información básica del usuario.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: Registro exitoso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthSuccessResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: Email ya registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/auth/login:
    post:
      operationId: loginWithPassword
      tags:
        - Auth
      summary: Autenticación por email y contraseña
      description: |
        Valida las credenciales y emite un nuevo par de tokens JWT/refresh.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Autenticación exitosa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthSuccessResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/auth/google:
    post:
      operationId: loginWithGoogle
      tags:
        - Auth
      summary: Login con Google OAuth
      description: |
        Valida un ID token de Google. Crea o vincula la cuenta y responde con tokens de acceso.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleLoginRequest'
      responses:
        '200':
          description: Autenticación exitosa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthSuccessResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/auth/refresh-token:
    post:
      operationId: refreshAccessToken
      tags:
        - Auth
      summary: Renovar access token usando refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Nuevo access token emitido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshTokenResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/auth/logout:
    post:
      operationId: revokeRefreshToken
      tags:
        - Auth
      summary: Revocar un refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogoutRequest'
      responses:
        '204':
          description: Refresh token revocado
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/challenges/today:
    get:
      operationId: getTodayChallenge
      tags:
        - Challenges
      summary: Obtener desafío diario de hoy
      description: Retorna el desafío del día actual y el progreso del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Desafío del día
          content:
            application/json:
              schema:
                type: object
                properties:
                  challenge:
                    $ref: '#/components/schemas/TodayChallengeResponse'
        '400':
          description: Error al obtener desafío
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/challenges/{id}/progress:
    put:
      operationId: updateChallengeProgress
      tags:
        - Challenges
      summary: Actualizar progreso del desafío diario
      description: Actualiza el progreso del usuario en el desafío. Si alcanza el objetivo, otorga tokens automáticamente.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - value
              properties:
                value:
                  type: integer
                  description: Valor actual del progreso
                  example: 500
                  minimum: 0
      responses:
        '200':
          description: Progreso actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChallengeProgressResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/daily-challenge-templates:
    get:
      operationId: listDailyChallengeTemplates
      tags:
        - Challenges
      summary: Listar plantillas de desafíos
      description: Obtiene la lista de plantillas de desafíos diarios (admin)
      security:
        - BearerAuth: []
      parameters:
        - name: is_active
          in: query
          required: false
          schema:
            type: boolean
          description: Filtrar solo plantillas activas
      responses:
        '200':
          description: Lista de plantillas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DailyChallengeTemplateResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createDailyChallengeTemplate
      tags:
        - Challenges
      summary: Crear una nueva plantilla de desafío
      description: Crea una nueva plantilla de desafío diario (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDailyChallengeTemplateRequest'
      responses:
        '201':
          description: Plantilla creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeTemplateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/daily-challenge-templates/{id}:
    get:
      operationId: getDailyChallengeTemplateById
      tags:
        - Challenges
      summary: Obtener una plantilla por ID
      description: Obtiene los detalles de una plantilla específica
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la plantilla
      responses:
        '200':
          description: Detalles de la plantilla
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeTemplateResponse'
        '404':
          description: Plantilla no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      operationId: updateDailyChallengeTemplate
      tags:
        - Challenges
      summary: Actualizar una plantilla
      description: Actualiza los datos de una plantilla (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la plantilla
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDailyChallengeTemplateRequest'
      responses:
        '200':
          description: Plantilla actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeTemplateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          description: Plantilla no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: deleteDailyChallengeTemplate
      tags:
        - Challenges
      summary: Eliminar una plantilla
      description: Elimina una plantilla de desafío
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la plantilla
      responses:
        '204':
          description: Plantilla eliminada exitosamente
        '404':
          description: Plantilla no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/admin/daily-challenges:
    get:
      operationId: listAdminDailyChallenges
      tags:
        - Challenges
      summary: Listar desafíos diarios
      description: Obtiene la lista de desafíos diarios (admin) (alias de /api/daily-challenges)
      security:
        - BearerAuth: []
      parameters:
        - name: from_date
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Fecha inicial (YYYY-MM-DD)
        - name: to_date
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Fecha final (YYYY-MM-DD)
      responses:
        '200':
          description: Lista de desafíos diarios
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DailyChallengeResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createAdminDailyChallenge
      tags:
        - Challenges
      summary: Crear un nuevo desafío diario
      description: Crea un nuevo desafío diario (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDailyChallengeRequest'
      responses:
        '201':
          description: Desafío creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/admin/daily-challenges/{id}:
    get:
      operationId: getAdminDailyChallengeById
      tags:
        - Challenges
      summary: Obtener un desafío diario por ID
      description: Obtiene los detalles de un desafío diario específico (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      responses:
        '200':
          description: Detalles del desafío
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateAdminDailyChallenge
      tags:
        - Challenges
      summary: Actualizar un desafío diario
      description: Actualiza los datos de un desafío diario (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDailyChallengeRequest'
      responses:
        '200':
          description: Desafío actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteAdminDailyChallenge
      tags:
        - Challenges
      summary: Eliminar un desafío diario
      description: Elimina un desafío diario (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      responses:
        '204':
          description: Desafío eliminado exitosamente
        '404':
          $ref: '#/components/responses/NotFound'
  /api/daily-challenges:
    get:
      operationId: listDailyChallenges
      tags:
        - Challenges
      summary: Listar desafíos diarios
      description: Obtiene la lista de desafíos diarios (admin)
      security:
        - BearerAuth: []
      parameters:
        - name: from_date
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Fecha inicial (YYYY-MM-DD)
        - name: to_date
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Fecha final (YYYY-MM-DD)
      responses:
        '200':
          description: Lista de desafíos diarios
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DailyChallengeResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createDailyChallenge
      tags:
        - Challenges
      summary: Crear un nuevo desafío diario
      description: Crea un nuevo desafío diario (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDailyChallengeRequest'
      responses:
        '201':
          description: Desafío creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/daily-challenges/{id}:
    get:
      operationId: getDailyChallengeById
      tags:
        - Challenges
      summary: Obtener un desafío diario por ID
      description: Obtiene los detalles de un desafío diario específico
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      responses:
        '200':
          description: Detalles del desafío
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateDailyChallenge
      tags:
        - Challenges
      summary: Actualizar un desafío diario
      description: Actualiza los datos de un desafío diario (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDailyChallengeRequest'
      responses:
        '200':
          description: Desafío actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailyChallengeResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteDailyChallenge
      tags:
        - Challenges
      summary: Eliminar un desafío diario
      description: Elimina un desafío diario
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del desafío
      responses:
        '204':
          description: Desafío eliminado exitosamente
        '404':
          $ref: '#/components/responses/NotFound'
  /api/exercises:
    get:
      operationId: listExercises
      tags:
        - Exercises
      summary: Listar ejercicios con paginación
      description: Retorna la lista de ejercicios con paginación (alias de /api/exercises/paginated)
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: muscular_group
          in: query
          schema:
            type: string
        - name: difficulty
          in: query
          schema:
            type: string
            enum:
              - beginner
              - intermediate
              - advanced
      responses:
        '200':
          description: Lista paginada de ejercicios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExercisesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
    post:
      operationId: createExercise
      tags:
        - Exercises
      summary: Crear un nuevo ejercicio
      description: Crea un nuevo ejercicio en el sistema (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExerciseRequest'
      responses:
        '201':
          description: Ejercicio creado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Exercise'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/exercises/paginated:
    get:
      operationId: listExercisesPaginated
      tags:
        - Exercises
      summary: Listar ejercicios con paginación
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: muscular_group
          in: query
          schema:
            type: string
        - name: difficulty
          in: query
          schema:
            type: string
            enum:
              - beginner
              - intermediate
              - advanced
      responses:
        '200':
          description: Lista paginada de ejercicios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExercisesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/exercises/{id}:
    get:
      operationId: getExerciseById
      tags:
        - Exercises
      summary: Obtener ejercicio por ID
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Ejercicio encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/Exercise'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateExercise
      tags:
        - Exercises
      summary: Actualizar ejercicio
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExerciseRequest'
      responses:
        '200':
          description: Ejercicio actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Exercise'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteExercise
      tags:
        - Exercises
      summary: Eliminar ejercicio
      description: Solo el creador o admin puede eliminar
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Ejercicio eliminado
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/frequency:
    post:
      operationId: createWeeklyGoal
      tags:
        - Frequency
      summary: Crear o actualizar meta semanal
      description: Define la meta semanal de asistencias del usuario.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - goal
              properties:
                goal:
                  type: integer
                  description: Número de asistencias objetivo por semana
                  example: 3
                  minimum: 1
      responses:
        '201':
          description: Meta creada o actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FrequencyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/frequency/me:
    get:
      operationId: getUserFrequency
      tags:
        - Frequency
      summary: Consultar estado de frecuencia semanal
      description: Retorna la meta semanal y el progreso del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Estado actual de frecuencia
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FrequencyResponse'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Frecuencia no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/frequency/reset:
    put:
      operationId: resetAllFrequencies
      tags:
        - Frequency
      summary: Reiniciar todas las frecuencias semanales (Admin)
      description: Reinicia los contadores de asistencias de todos los usuarios (cron semanal).
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Frecuencias reiniciadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Frecuencias reiniciadas con éxito
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Requiere permisos de administrador
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/gym-requests:
    get:
      tags:
        - Gym Requests
      summary: Obtener todas las solicitudes de gimnasios
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum:
              - pending
              - approved
              - rejected
      responses:
        '200':
          description: Solicitudes obtenidas exitosamente
          content:
            application/json:
              schema:
                type: object
    post:
      tags:
        - Gym Requests
      summary: Crear solicitud de gimnasio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymRequestDTO'
      responses:
        '201':
          description: Solicitud creada exitosamente
          content:
            application/json:
              schema:
                type: object
  /api/gym-requests/{id}:
    get:
      tags:
        - Gym Requests
      summary: Obtener solicitud por ID
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Solicitud obtenida
    delete:
      tags:
        - Gym Requests
      summary: Eliminar solicitud
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Solicitud eliminada
  /api/gym-requests/{id}/approve:
    post:
      tags:
        - Gym Requests
      summary: Aprobar solicitud
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Solicitud aprobada
  /api/gym-requests/{id}/reject:
    post:
      tags:
        - Gym Requests
      summary: Rechazar solicitud
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Solicitud rechazada
  /api/gym-special-schedules/{gymId}:
    get:
      operationId: listGymSpecialSchedules
      tags:
        - Gym Schedules
      summary: Listar horarios especiales de un gimnasio
      description: Obtiene todos los horarios especiales de un gimnasio específico
      security:
        - BearerAuth: []
      parameters:
        - name: gymId
          in: path
          required: true
          schema:
            type: integer
          description: ID del gimnasio
      responses:
        '200':
          description: Lista de horarios especiales
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GymSpecialScheduleResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    post:
      operationId: createGymSpecialSchedule
      tags:
        - Gym Schedules
      summary: Crear un horario especial
      description: Crea un nuevo horario especial para el gimnasio (admin)
      security:
        - BearerAuth: []
      parameters:
        - name: gymId
          in: path
          required: true
          schema:
            type: integer
          description: ID del gimnasio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymSpecialScheduleRequest'
      responses:
        '201':
          description: Horario especial creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymSpecialScheduleResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/gym-special-schedules/{id}:
    put:
      operationId: updateGymSpecialSchedule
      tags:
        - Gym Schedules
      summary: Actualizar un horario especial
      description: Actualiza los datos de un horario especial (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del horario especial
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGymSpecialScheduleRequest'
      responses:
        '200':
          description: Horario especial actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymSpecialScheduleResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteGymSpecialSchedule
      tags:
        - Gym Schedules
      summary: Eliminar un horario especial
      description: Elimina un horario especial
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID del horario especial
      responses:
        '204':
          description: Horario especial eliminado exitosamente
        '404':
          $ref: '#/components/responses/NotFound'
  /api/gyms:
    get:
      operationId: listGyms
      tags:
        - Gyms
      summary: Listar gimnasios
      description: Obtiene la lista de gimnasios con paginación
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: city
          in: query
          schema:
            type: string
          description: Filtrar por ciudad
        - name: is_active
          in: query
          schema:
            type: boolean
          description: Filtrar solo gimnasios activos
        - name: featured
          in: query
          schema:
            type: boolean
          description: Filtrar solo gimnasios destacados
      responses:
        '200':
          description: Lista paginada de gimnasios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
    post:
      operationId: createGym
      tags:
        - Gyms
      summary: Crear un nuevo gimnasio
      description: Crea un nuevo gimnasio en el sistema (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymRequest'
      responses:
        '201':
          description: Gimnasio creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/gyms/{gymId}:
    parameters:
      - $ref: '#/components/parameters/GymIdPathParam'
    get:
      operationId: getGym
      tags:
        - Gyms
      summary: Obtener detalle de un gimnasio
      responses:
        '200':
          description: Gimnasio encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateGym
      tags:
        - Gyms
      summary: Actualizar un gimnasio
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGymRequest'
      responses:
        '200':
          description: Gimnasio actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteGym
      tags:
        - Gyms
      summary: Eliminar un gimnasio
      security:
        - BearerAuth: []
      responses:
        '204':
          description: Gimnasio eliminado
        '404':
          $ref: '#/components/responses/NotFound'
  /api/gyms/amenidades:
    get:
      operationId: listGymAmenities
      tags:
        - Gyms
      summary: Listar amenities disponibles
      responses:
        '200':
          description: Amenities registradas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GymAmenity'
        '400':
          description: Parámetros inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/gyms/{gymId}/schedules:
    parameters:
      - $ref: '#/components/parameters/GymIdPathParam'
    get:
      operationId: listGymSchedules
      tags:
        - Gym Schedules
      summary: Listar horarios regulares de un gimnasio
      description: Retorna los horarios de la semana (lunes a domingo)
      responses:
        '200':
          description: Horarios encontrados
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymSchedulesWeekResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    post:
      operationId: createGymSchedule
      tags:
        - Gym Schedules
      summary: Crear horario regular para un día
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymScheduleRequest'
      responses:
        '201':
          description: Horario creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymScheduleResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/gyms/{gymId}/reviews:
    parameters:
      - $ref: '#/components/parameters/GymIdPathParam'
    get:
      operationId: listGymReviews
      tags:
        - Gym Reviews
      summary: Listar reseñas de un gimnasio
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: sortBy
          in: query
          schema:
            type: string
            enum:
              - created_at
              - rating
              - helpful_count
            default: created_at
        - $ref: '#/components/parameters/OrderParam'
        - name: min_rating
          in: query
          schema:
            type: number
            minimum: 1
            maximum: 5
        - name: with_comment_only
          in: query
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Lista de reseñas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGymReviewsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    post:
      operationId: createGymReview
      tags:
        - Gym Reviews
      summary: Crear una reseña para un gimnasio
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymReviewRequest'
      responses:
        '201':
          description: Reseña creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymReviewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Usuario ya tiene una reseña para este gimnasio
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/gyms/{gymId}/reviews/stats:
    parameters:
      - $ref: '#/components/parameters/GymIdPathParam'
    get:
      operationId: getGymRatingStats
      tags:
        - Gym Reviews
      summary: Obtener estadísticas de rating de un gimnasio
      description: Devuelve estadísticas agregadas de las reseñas de un gimnasio (promedio, distribución por estrellas, etc.)
      responses:
        '200':
          description: Estadísticas de rating del gimnasio
          content:
            application/json:
              schema:
                type: object
                required:
                  - id_gym
                  - avg_rating
                  - total_reviews
                properties:
                  id_gym:
                    type: integer
                  avg_rating:
                    type: number
                    format: float
                    minimum: 0
                    maximum: 5
                  total_reviews:
                    type: integer
                    minimum: 0
                  rating_5_count:
                    type: integer
                  rating_4_count:
                    type: integer
                  rating_3_count:
                    type: integer
                  rating_2_count:
                    type: integer
                  rating_1_count:
                    type: integer
                  avg_cleanliness:
                    type: number
                    format: float
                    nullable: true
                  avg_equipment:
                    type: number
                    format: float
                    nullable: true
                  avg_staff:
                    type: number
                    format: float
                    nullable: true
                  avg_value:
                    type: number
                    format: float
                    nullable: true
                  last_review_date:
                    type: string
                    format: date-time
                    nullable: true
                  updated_at:
                    type: string
                    format: date-time
        '404':
          $ref: '#/components/responses/NotFound'
  /api/gyms/{gymId}/payments:
    parameters:
      - $ref: '#/components/parameters/GymIdPathParam'
    get:
      operationId: listGymPayments
      tags:
        - Gym Payments
      summary: Listar pagos de un gimnasio
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: status
          in: query
          schema:
            type: string
            enum:
              - PENDING
              - COMPLETED
              - FAILED
              - REFUNDED
        - name: from_date
          in: query
          schema:
            type: string
            format: date
        - name: to_date
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Lista de pagos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGymPaymentsResponse'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      operationId: createGymPayment
      tags:
        - Gym Payments
      summary: Registrar un pago de suscripción a gimnasio
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymPaymentRequest'
      responses:
        '201':
          description: Pago registrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymPaymentResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/gym-reviews:
    get:
      operationId: listAllGymReviews
      tags:
        - Gym Reviews
      summary: Listar todas las reseñas de gimnasios
      description: Obtiene la lista de reseñas de todos los gimnasios con paginación
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: sortBy
          in: query
          schema:
            type: string
            enum:
              - created_at
              - rating
              - helpful_count
            default: created_at
        - $ref: '#/components/parameters/OrderParam'
        - name: min_rating
          in: query
          schema:
            type: number
            minimum: 1
            maximum: 5
        - name: with_comment_only
          in: query
          schema:
            type: boolean
            default: false
        - name: gym_id
          in: query
          schema:
            type: integer
          description: Filtrar por ID de gimnasio
      responses:
        '200':
          description: Lista paginada de reseñas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGymReviewsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/gym-reviews/{reviewId}:
    parameters:
      - name: reviewId
        in: path
        required: true
        schema:
          type: integer
        description: ID de la reseña
    put:
      operationId: updateGymReview
      tags:
        - Gym Reviews
      summary: Actualizar una reseña
      description: Actualiza una reseña existente (admin o autor)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymReviewRequest'
      responses:
        '200':
          description: Reseña actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymReviewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      operationId: patchGymReview
      tags:
        - Gym Reviews
      summary: Actualizar una reseña (PATCH)
      description: Actualiza una reseña existente (admin o autor) - Alias de PUT
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymReviewRequest'
      responses:
        '200':
          description: Reseña actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GymReviewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteGymReview
      tags:
        - Gym Reviews
      summary: Eliminar una reseña
      description: Elimina una reseña (admin o autor)
      security:
        - BearerAuth: []
      responses:
        '204':
          description: Reseña eliminada exitosamente
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/media:
    get:
      operationId: listUserMedia
      tags:
        - Media
      summary: Listar archivos multimedia del usuario
      description: |
        Obtiene todos los archivos multimedia asociados al usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Lista de archivos multimedia
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MediaResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createMedia
      tags:
        - Media
      summary: Crear un nuevo archivo multimedia
      description: |
        Crea un nuevo registro de archivo multimedia asociado a una entidad (usuario, gimnasio, ejercicio, progreso).
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - entity_type
                - entity_id
                - url
              properties:
                entity_type:
                  $ref: '#/components/schemas/EntityType'
                  description: Tipo de entidad
                  example: GYM
                entity_id:
                  type: integer
                  description: ID de la entidad
                  example: 5
                media_type:
                  allOf:
                    - $ref: '#/components/schemas/MediaType'
                  default: IMAGE
                  description: Tipo de archivo
                url:
                  type: string
                  format: uri
                  description: URL del archivo
                  example: https://example.com/gym.jpg
                thumbnail_url:
                  type: string
                  format: uri
                  description: URL de la miniatura
                  example: https://example.com/gym-thumb.jpg
                file_size:
                  type: integer
                  description: Tamaño del archivo en bytes
                  example: 1024000
                mime_type:
                  type: string
                  description: Tipo MIME del archivo
                  example: image/jpeg
                width:
                  type: integer
                  description: Ancho de la imagen en píxeles
                  example: 1920
                height:
                  type: integer
                  description: Alto de la imagen en píxeles
                  example: 1080
                is_primary:
                  type: boolean
                  default: false
                  description: Si es el archivo principal de la entidad
                display_order:
                  type: integer
                  default: 0
                  description: Orden de visualización
      responses:
        '201':
          description: Archivo multimedia creado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/MediaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/media/{entity_type}/{entity_id}:
    get:
      operationId: listMediaByEntity
      tags:
        - Media
      summary: Listar archivos multimedia de una entidad
      description: |
        Obtiene todos los archivos multimedia asociados a una entidad específica (usuario, gimnasio, ejercicio, progreso).
      parameters:
        - name: entity_type
          in: path
          required: true
          schema:
            type: string
            enum:
              - USER_PROFILE
              - GYM
              - EXERCISE
              - PROGRESS
          description: Tipo de entidad
          example: GYM
        - name: entity_id
          in: path
          required: true
          schema:
            type: integer
          description: ID de la entidad
          example: 5
        - name: media_type
          in: query
          schema:
            type: string
            enum:
              - IMAGE
              - VIDEO
          description: Filtrar por tipo de archivo
      responses:
        '200':
          description: Lista de archivos multimedia
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MediaResponse'
        '400':
          description: Parámetros inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/media/{id_media}/primary:
    post:
      operationId: setPrimaryMedia
      tags:
        - Media
      summary: Establecer archivo como principal
      description: |
        Marca un archivo multimedia como principal para su entidad. Automáticamente desmarca otros archivos de la misma entidad.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/MediaIdPathParam'
          description: ID del archivo multimedia
          example: 1
      responses:
        '200':
          description: Archivo marcado como principal
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/MediaResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/media/{id_media}:
    delete:
      operationId: deleteMedia
      tags:
        - Media
      summary: Eliminar archivo multimedia
      description: |
        Elimina un archivo multimedia del sistema.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/MediaIdPathParam'
          description: ID del archivo multimedia
          example: 1
      responses:
        '204':
          description: Archivo eliminado exitosamente
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/progress:
    post:
      operationId: registerProgress
      tags:
        - Progress
      summary: Registrar progreso físico del usuario
      description: |
        Registra el progreso físico del usuario incluyendo peso total levantado, repeticiones totales, sets totales y ejercicios realizados.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - date
                - total_weight_lifted
                - total_reps
                - total_sets
              properties:
                date:
                  type: string
                  format: date
                  description: Fecha del registro
                  example: '2025-01-15'
                total_weight_lifted:
                  type: number
                  format: float
                  description: Peso total levantado en kg
                  example: 5000
                total_reps:
                  type: integer
                  description: Repeticiones totales
                  example: 100
                total_sets:
                  type: integer
                  description: Sets totales
                  example: 20
                notes:
                  type: string
                  description: Notas adicionales
                  example: Great workout session
                exercises:
                  type: array
                  description: Lista de ejercicios realizados
                  items:
                    type: object
                    required:
                      - id_exercise
                      - used_weight
                      - reps
                    properties:
                      id_exercise:
                        type: integer
                        description: ID del ejercicio
                        example: 5
                      used_weight:
                        type: number
                        format: float
                        description: Peso utilizado en kg
                        example: 80
                      reps:
                        type: integer
                        description: Número de repeticiones
                        example: 10
                      sets:
                        type: integer
                        description: Número de sets
                        example: 3
                        default: 1
      responses:
        '201':
          description: Progreso registrado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Progreso registrado con éxito
                  data:
                    $ref: '#/components/schemas/ProgressResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me:
    get:
      operationId: getUserProgress
      tags:
        - Progress
      summary: Obtener historial de progreso del usuario
      description: |
        Obtiene todo el historial de progreso físico del usuario autenticado con opciones de paginación y filtrado.
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Número máximo de registros a retornar
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Número de registros a saltar
        - name: include_exercises
          in: query
          schema:
            type: boolean
            default: false
          description: Incluir detalles de ejercicios
      responses:
        '200':
          description: Historial de progreso obtenido
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProgressResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me/estadistica:
    get:
      operationId: getWeightStats
      tags:
        - Progress
      summary: Obtener estadísticas de peso levantado
      description: |
        Obtiene estadísticas de peso total levantado del usuario en un rango de fechas opcional.
      security:
        - BearerAuth: []
      parameters:
        - name: start_date
          in: query
          schema:
            type: string
            format: date
          description: Fecha de inicio del rango
          example: '2025-01-01'
        - name: end_date
          in: query
          schema:
            type: string
            format: date
          description: Fecha de fin del rango
          example: '2025-01-31'
      responses:
        '200':
          description: Estadísticas obtenidas
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        total_weight_lifted:
                          type: number
                        total_reps:
                          type: integer
                        total_sets:
                          type: integer
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me/ejercicios:
    get:
      operationId: getExerciseHistory
      tags:
        - Progress
      summary: Obtener historial completo de ejercicios
      description: |
        Obtiene el historial completo de todos los ejercicios realizados por el usuario autenticado.
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 100
          description: Número máximo de registros
      responses:
        '200':
          description: Historial de ejercicios obtenido
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        exercise_name:
                          type: string
                        muscular_group:
                          type: string
                        used_weight:
                          type: number
                        reps:
                          type: integer
                        sets:
                          type: integer
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me/ejercicios/{id_exercise}:
    get:
      operationId: getExerciseHistoryByExercise
      tags:
        - Progress
      summary: Obtener historial de un ejercicio específico
      description: |
        Obtiene el historial de un ejercicio específico del usuario autenticado.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ExerciseIdPathParam'
          description: ID del ejercicio
          example: 5
      responses:
        '200':
          description: Historial del ejercicio obtenido
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        used_weight:
                          type: number
                        reps:
                          type: integer
                        sets:
                          type: integer
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me/ejercicios/{id_exercise}/mejor:
    get:
      operationId: getPersonalRecord
      tags:
        - Progress
      summary: Obtener récord personal de un ejercicio
      description: |
        Obtiene el mejor levantamiento (peso máximo) del usuario para un ejercicio específico.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ExerciseIdPathParam'
          description: ID del ejercicio
          example: 5
      responses:
        '200':
          description: Récord personal obtenido
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      date:
                        type: string
                        format: date
                      used_weight:
                        type: number
                      reps:
                        type: integer
                      sets:
                        type: integer
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/progress/me/ejercicios/{id_exercise}/promedio:
    get:
      operationId: getExerciseAverages
      tags:
        - Progress
      summary: Obtener promedios de un ejercicio
      description: |
        Obtiene los promedios de peso, repeticiones y sets para un ejercicio específico del usuario.
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ExerciseIdPathParam'
          description: ID del ejercicio
          example: 5
      responses:
        '200':
          description: Promedios obtenidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      average_weight:
                        type: number
                        description: Peso promedio
                      average_reps:
                        type: number
                        description: Repeticiones promedio
                      average_sets:
                        type: number
                        description: Sets promedio
                      total_records:
                        type: integer
                        description: Total de registros
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/rewards:
    get:
      operationId: listRewards
      tags:
        - Rewards
      summary: Listar todas las recompensas
      description: Obtiene la lista de todas las recompensas disponibles
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/AvailableQueryParam'
          description: Filtrar solo recompensas disponibles
      responses:
        '200':
          description: Lista de recompensas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RewardResponse'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createReward
      tags:
        - Rewards
      summary: Crear una nueva recompensa
      description: Crea una nueva recompensa en el sistema (admin)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRewardRequest'
      responses:
        '201':
          description: Recompensa creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RewardResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/rewards/{id}:
    get:
      operationId: getRewardById
      tags:
        - Rewards
      summary: Obtener una recompensa por ID
      description: Obtiene los detalles de una recompensa específica
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la recompensa
      responses:
        '200':
          description: Detalles de la recompensa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RewardResponse'
        '404':
          description: Recompensa no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      operationId: updateReward
      tags:
        - Rewards
      summary: Actualizar una recompensa
      description: Actualiza los datos de una recompensa existente (admin)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la recompensa
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRewardRequest'
      responses:
        '200':
          description: Recompensa actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RewardResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          description: Recompensa no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: deleteReward
      tags:
        - Rewards
      summary: Eliminar una recompensa
      description: Elimina lógicamente una recompensa (soft delete)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
          description: ID de la recompensa
      responses:
        '204':
          description: Recompensa eliminada exitosamente
        '404':
          description: Recompensa no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/routines:
    post:
      operationId: createRoutineWithExercises
      tags:
        - Routines
      summary: Crear rutina con ejercicios
      description: Crea una rutina con al menos 2 ejercicios
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoutineRequest'
      responses:
        '201':
          description: Rutina creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineWithDetails'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/routines/me:
    get:
      operationId: getMyRoutines
      tags:
        - Routines
      summary: Obtener mis rutinas
      description: Lista las rutinas del usuario autenticado
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: Lista de rutinas del usuario
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Routine'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/routines/templates:
    get:
      operationId: listRoutineTemplates
      tags:
        - Routines
      summary: Listar plantillas de rutinas
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: Lista paginada de templates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRoutinesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/routines/{id}:
    get:
      operationId: getRoutineById
      tags:
        - Routines
      summary: Obtener rutina por ID
      description: Obtiene rutina con ejercicios y días
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Rutina encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineWithDetails'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateRoutine
      tags:
        - Routines
      summary: Actualizar rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoutineRequest'
      responses:
        '200':
          description: Rutina actualizada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Routine'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteRoutine
      tags:
        - Routines
      summary: Eliminar rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Rutina eliminada
        '404':
          $ref: '#/components/responses/NotFound'
  /api/routines/{id}/exercises:
    post:
      operationId: addExerciseToRoutine
      tags:
        - Routines
      summary: Agregar ejercicio a rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddExerciseToRoutineRequest'
      responses:
        '201':
          description: Ejercicio agregado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineExercise'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/routines/{id}/exercises/{id_exercise}:
    put:
      operationId: updateRoutineExercise
      tags:
        - Routines
      summary: Actualizar ejercicio en rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
        - $ref: '#/components/parameters/ExerciseIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoutineExerciseRequest'
      responses:
        '200':
          description: Ejercicio actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineExercise'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteRoutineExercise
      tags:
        - Routines
      summary: Eliminar ejercicio de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
        - $ref: '#/components/parameters/ExerciseIdPathParam'
      responses:
        '204':
          description: Ejercicio eliminado de rutina
        '404':
          $ref: '#/components/responses/NotFound'
  /api/routines/{id}/days:
    get:
      operationId: listRoutineDays
      tags:
        - Routines
      summary: Listar días de rutina
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Lista de días
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/RoutineDay'
        '404':
          $ref: '#/components/responses/NotFound'
    post:
      operationId: createRoutineDay
      tags:
        - Routines
      summary: Crear día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoutineDayRequest'
      responses:
        '201':
          description: Día creado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineDay'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/routines/days/{id_routine_day}:
    put:
      operationId: updateRoutineDay
      tags:
        - Routines
      summary: Actualizar día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/RoutineDayIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoutineDayRequest'
      responses:
        '200':
          description: Día actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineDay'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteRoutineDay
      tags:
        - Routines
      summary: Eliminar día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/RoutineDayIdPathParam'
      responses:
        '204':
          description: Día eliminado
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/streak/me:
    get:
      operationId: getUserStreak
      tags:
        - Streaks
      summary: Obtener racha actual del usuario
      description: Retorna la racha de asistencias del usuario autenticado con estadísticas.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Racha del usuario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StreakResponse'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Racha no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/streak/use-recovery:
    post:
      operationId: useRecoveryItem
      tags:
        - Streaks
      summary: Usar item de recuperación
      description: Consume un item de recuperación para mantener la racha activa.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Item usado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Item de recuperación usado exitosamente
                  recovery_items_remaining:
                    type: integer
                    example: 2
                  streak_value:
                    type: integer
                    example: 15
        '400':
          description: Sin items disponibles o error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/streak/stats:
    get:
      operationId: getStreakStats
      tags:
        - Streaks
      summary: Estadísticas globales de rachas (Admin)
      description: Retorna estadísticas del sistema de rachas.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Estadísticas obtenidas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StreakStatsResponse'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Requiere permisos de administrador
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/streak/{id_user_profile}/reset:
    put:
      operationId: resetUserStreak
      tags:
        - Streaks
      summary: Resetear racha de usuario (Admin)
      description: Reinicia la racha de un usuario a cero.
      security:
        - BearerAuth: []
      parameters:
        - name: id_user_profile
          in: path
          required: true
          description: ID del perfil de usuario
          schema:
            type: integer
      responses:
        '200':
          description: Racha reseteada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Racha reseteada exitosamente
                  racha:
                    $ref: '#/components/schemas/StreakResponse'
        '400':
          description: Error al resetear
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Requiere permisos de administrador
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/streak/{id_user_profile}/grant-recovery:
    post:
      operationId: grantRecoveryItems
      tags:
        - Streaks
      summary: Otorgar items de recuperación (Admin)
      description: Añade items de recuperación a la racha de un usuario.
      security:
        - BearerAuth: []
      parameters:
        - name: id_user_profile
          in: path
          required: true
          description: ID del perfil de usuario
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - cantidad
              properties:
                cantidad:
                  type: integer
                  description: Cantidad de items a otorgar
                  example: 3
                  minimum: 1
      responses:
        '200':
          description: Items otorgados
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Se otorgaron 3 item(s) de recuperación
                  racha:
                    $ref: '#/components/schemas/StreakResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Autenticación requerida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Requiere permisos de administrador
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/users/me/body-metrics:
    post:
      summary: Crear métrica corporal
      description: |
        Registra una nueva métrica corporal para el usuario.

        **Restricciones:**
        - Usuarios PREMIUM: Pueden crear 1 métrica por semana (cada 7 días)
        - Usuarios FREE: Pueden crear 1 métrica por mes
        - Tokens: Se otorgan 5 tokens solo 1 vez por mes (independientemente de la suscripción)

        **Edición:** Para modificar métricas existentes, usar PUT /api/users/me/body-metrics/{id_metric}
      tags:
        - Body Metrics
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - date
              properties:
                date:
                  type: string
                  format: date
                  description: Fecha de la medición (YYYY-MM-DD)
                  example: '2025-10-30'
                weight_kg:
                  type: number
                  format: float
                  minimum: 20
                  maximum: 300
                  description: Peso en kilogramos
                  example: 72.5
                height_cm:
                  type: number
                  format: float
                  minimum: 50
                  maximum: 250
                  description: Altura en centímetros
                  example: 175
                body_fat_percentage:
                  type: number
                  format: float
                  minimum: 1
                  maximum: 60
                  description: Porcentaje de grasa corporal
                  example: 18.5
                muscle_mass_kg:
                  type: number
                  format: float
                  minimum: 10
                  maximum: 200
                  description: Masa muscular en kilogramos
                  example: 45.2
                waist_cm:
                  type: number
                  format: float
                  minimum: 30
                  maximum: 250
                  description: Cintura en centímetros
                  example: 85
                chest_cm:
                  type: number
                  format: float
                  minimum: 30
                  maximum: 200
                  description: Pecho en centímetros
                  example: 100
                arms_cm:
                  type: number
                  format: float
                  minimum: 15
                  maximum: 100
                  description: Brazos en centímetros
                  example: 35
                notes:
                  type: string
                  maxLength: 500
                  description: Notas opcionales
                  example: Medición después del entrenamiento
      responses:
        '201':
          description: Métrica corporal creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Métrica corporal registrada exitosamente
                  data:
                    type: object
                    properties:
                      id_metric:
                        type: integer
                      id_user_profile:
                        type: integer
                      date:
                        type: string
                        format: date
                      weight_kg:
                        type: number
                      height_cm:
                        type: number
                      bmi:
                        type: number
                      body_fat_percentage:
                        type: number
                      muscle_mass_kg:
                        type: number
                      waist_cm:
                        type: number
                      chest_cm:
                        type: number
                      arms_cm:
                        type: number
                      notes:
                        type: string
                      created_at:
                        type: string
                        format: date-time
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      summary: Listar métricas corporales del usuario
      description: Obtiene el historial de métricas corporales del usuario
      tags:
        - Body Metrics
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 100
          description: Número máximo de resultados
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
            minimum: 0
          description: Número de resultados a saltar
      responses:
        '200':
          description: Lista de métricas corporales
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id_metric:
                          type: integer
                        id_user_profile:
                          type: integer
                        date:
                          type: string
                          format: date
                        weight_kg:
                          type: number
                        height_cm:
                          type: number
                        bmi:
                          type: number
                        body_fat_percentage:
                          type: number
                        muscle_mass_kg:
                          type: number
                        waist_cm:
                          type: number
                        chest_cm:
                          type: number
                        arms_cm:
                          type: number
                        notes:
                          type: string
                        created_at:
                          type: string
                          format: date-time
                  total:
                    type: integer
                  limit:
                    type: integer
                  offset:
                    type: integer
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/users/me/body-metrics/{id_metric}:
    put:
      summary: Actualizar métrica corporal
      description: Actualiza una métrica corporal existente del usuario. No otorga tokens.
      tags:
        - Body Metrics
      security:
        - bearerAuth: []
      parameters:
        - name: id_metric
          in: path
          required: true
          schema:
            type: integer
          description: ID de la métrica corporal a actualizar
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                weight_kg:
                  type: number
                  format: float
                  minimum: 20
                  maximum: 300
                  description: Peso en kilogramos
                height_cm:
                  type: number
                  format: float
                  minimum: 50
                  maximum: 250
                  description: Altura en centímetros
                body_fat_percentage:
                  type: number
                  format: float
                  minimum: 1
                  maximum: 60
                  description: Porcentaje de grasa corporal
                muscle_mass_kg:
                  type: number
                  format: float
                  minimum: 10
                  maximum: 200
                  description: Masa muscular en kilogramos
                waist_cm:
                  type: number
                  format: float
                  minimum: 30
                  maximum: 250
                  description: Cintura en centímetros
                chest_cm:
                  type: number
                  format: float
                  minimum: 30
                  maximum: 200
                  description: Pecho en centímetros
                arms_cm:
                  type: number
                  format: float
                  minimum: 15
                  maximum: 100
                  description: Brazos en centímetros
                notes:
                  type: string
                  maxLength: 500
                  description: Notas opcionales
      responses:
        '200':
          description: Métrica corporal actualizada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Métrica corporal actualizada exitosamente
                  data:
                    type: object
                    properties:
                      id_metric:
                        type: integer
                      id_user_profile:
                        type: integer
                      date:
                        type: string
                        format: date
                      weight_kg:
                        type: number
                      height_cm:
                        type: number
                      bmi:
                        type: number
                      body_fat_percentage:
                        type: number
                      muscle_mass_kg:
                        type: number
                      waist_cm:
                        type: number
                      chest_cm:
                        type: number
                      arms_cm:
                        type: number
                      notes:
                        type: string
                      created_at:
                        type: string
                        format: date-time
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Acceso denegado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Métrica no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/users/me/body-metrics/latest:
    get:
      summary: Obtener la métrica más reciente del usuario
      tags:
        - Body Metrics
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Métrica más reciente
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_metric:
                    type: integer
                  id_user_profile:
                    type: integer
                  date:
                    type: string
                    format: date
                  weight_kg:
                    type: number
                  height_cm:
                    type: number
                  bmi:
                    type: number
                  body_fat_percentage:
                    type: number
                  muscle_mass_kg:
                    type: number
                  waist_cm:
                    type: number
                  chest_cm:
                    type: number
                  arms_cm:
                    type: number
                  notes:
                    type: string
                  created_at:
                    type: string
                    format: date-time
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: No se encontraron métricas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-gym/alta:
    post:
      operationId: subscribeToGym
      tags:
        - User Gym Subscriptions
      summary: Dar de alta a un usuario en un gimnasio
      description: Suscribe al usuario autenticado a un gimnasio con un plan específico
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
                - plan
              properties:
                id_gym:
                  type: integer
                  description: ID del gimnasio
                  example: 2
                plan:
                  type: string
                  description: Plan de membresía
                  enum:
                    - MENSUAL
                    - SEMANAL
                    - ANUAL
                  example: MENSUAL
                subscription_start:
                  type: string
                  format: date
                  description: Fecha de inicio (opcional). Si no se envía, se usa la fecha actual
                  example: '2025-10-29'
                subscription_end:
                  type: string
                  format: date
                  description: Fecha de fin (opcional). Si no se envía, se calcula automáticamente según el plan
                  example: '2025-11-29'
      responses:
        '201':
          description: Usuario dado de alta correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Alta en gimnasio realizada con éxito
                  data:
                    type: object
                    properties:
                      id_user:
                        type: integer
                      id_gym:
                        type: integer
                      plan:
                        type: string
                        example: MENSUAL
                      active:
                        type: boolean
                      start_date:
                        type: string
                        format: date-time
        '400':
          description: Faltan datos requeridos o límite de gimnasios alcanzado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '422':
          description: Plan inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: INVALID_PLAN
                      message:
                        type: string
                        example: Plan inválido. Valores aceptados MENSUAL, SEMANAL, ANUAL
                      accepted_values:
                        type: array
                        items:
                          type: string
                        example:
                          - MENSUAL
                          - SEMANAL
                          - ANUAL
  /api/user-gym/baja:
    put:
      operationId: unsubscribeFromGym
      tags:
        - User Gym Subscriptions
      summary: Dar de baja al usuario en un gimnasio
      description: Cancela la suscripción del usuario autenticado a un gimnasio
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_gym
              properties:
                id_gym:
                  type: integer
                  description: ID del gimnasio
                  example: 2
      responses:
        '200':
          description: Usuario dado de baja correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Baja en gimnasio realizada con éxito
        '400':
          description: Faltan datos requeridos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Suscripción no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-gym/me/activos:
    get:
      operationId: getActiveGymSubscriptions
      tags:
        - User Gym Subscriptions
      summary: Obtener los gimnasios activos del usuario autenticado
      description: Lista todos los gimnasios donde el usuario tiene una suscripción activa
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Lista de gimnasios activos
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: ID de la relación user_gym
                    id_user_profile:
                      type: integer
                      description: ID del perfil de usuario
                    id_gym:
                      type: integer
                      description: ID del gimnasio
                    gym_name:
                      type: string
                      description: Nombre del gimnasio
                    plan:
                      type: string
                      enum:
                        - MENSUAL
                        - SEMANAL
                        - ANUAL
                    is_active:
                      type: boolean
                    subscription_start:
                      type: string
                      format: date
                    subscription_end:
                      type: string
                      format: date
                    trial_used:
                      type: boolean
                    trial_date:
                      type: string
                      format: date
                      description: Fecha en que usó el trial (null si no aplicó)
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-gym/me/historial:
    get:
      operationId: getUserGymHistory
      tags:
        - User Gym Subscriptions
      summary: Obtener historial completo de membresías del usuario autenticado
      description: Lista todas las membresías del usuario, activas e inactivas
      security:
        - BearerAuth: []
      parameters:
        - name: active
          in: query
          required: false
          schema:
            type: boolean
          description: Filtrar por estado (activo o no)
      responses:
        '200':
          description: Lista de membresías por gimnasio
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    id_user_profile:
                      type: integer
                    id_gym:
                      type: integer
                    gym_name:
                      type: string
                    plan:
                      type: string
                      enum:
                        - MENSUAL
                        - SEMANAL
                        - ANUAL
                    is_active:
                      type: boolean
                    subscription_start:
                      type: string
                      format: date
                    subscription_end:
                      type: string
                      format: date
                    trial_used:
                      type: boolean
                    trial_date:
                      type: string
                      format: date
                      description: Fecha en que usó el trial (null si no aplicó)
        '401':
          description: No autorizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-gym/gimnasio/{id_gym}/conteo:
    get:
      operationId: getGymMemberCount
      tags:
        - User Gym Subscriptions
      summary: Obtener cantidad de usuarios activos en un gimnasio
      description: Cuenta cuántos usuarios tienen suscripción activa en el gimnasio
      parameters:
        - name: id_gym
          in: path
          required: true
          schema:
            type: integer
          description: ID del gimnasio
      responses:
        '200':
          description: Cantidad de usuarios activos
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    example: 42
        '404':
          description: Gimnasio no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-gym/gimnasio/{id_gym}:
    get:
      operationId: getGymMemberHistory
      tags:
        - User Gym Subscriptions
      summary: Obtener historial de usuarios de un gimnasio
      description: Lista todos los usuarios que han tenido o tienen suscripción en el gimnasio
      parameters:
        - name: id_gym
          in: path
          required: true
          schema:
            type: integer
          description: ID del gimnasio
        - name: active
          in: query
          required: false
          schema:
            type: boolean
          description: Filtrar por estado (activo o no)
      responses:
        '200':
          description: Lista de usuarios que pasaron por el gimnasio
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    id_user_profile:
                      type: integer
                    id_gym:
                      type: integer
                    plan:
                      type: string
                    is_active:
                      type: boolean
                    subscription_start:
                      type: string
                      format: date
                    subscription_end:
                      type: string
                      format: date
        '404':
          description: Gimnasio no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-routines:
    post:
      operationId: assignRoutineToUser
      tags:
        - User Routines
      summary: Asignar rutina activa a usuario
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_routine
                - start_date
              properties:
                id_routine:
                  type: integer
                start_date:
                  type: string
                  format: date
      responses:
        '201':
          description: Rutina asignada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/UserRoutine'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/user-routines/me:
    get:
      operationId: getActiveRoutine
      tags:
        - User Routines
      summary: Obtener rutina activa del usuario
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Rutina activa
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/UserRoutine'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/user-routines/me/active-routine:
    get:
      operationId: getActiveRoutineWithExercises
      tags:
        - User Routines
      summary: Obtener rutina activa con ejercicios
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Rutina activa con ejercicios
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/RoutineWithDetails'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/user-routines/me/end:
    put:
      operationId: endUserRoutine
      tags:
        - User Routines
      summary: Finalizar rutina activa
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Rutina finalizada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/UserRoutine'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/me:
    get:
      operationId: getUserProfile
      tags:
        - Users
      summary: Obtener perfil del usuario actual
      description: |
        Devuelve la información completa del perfil del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Perfil del usuario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateUserProfile
      tags:
        - Users
      summary: Actualizar perfil del usuario actual
      description: |
        Actualiza los datos del perfil del usuario autenticado. Solo se actualizan los campos proporcionados en el request body.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserProfileRequest'
      responses:
        '200':
          description: Perfil actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: requestAccountDeletion
      tags:
        - Users
      summary: Solicitar eliminación de cuenta
      description: |
        Inicia el proceso de eliminación de cuenta con período de gracia. La cuenta no se eliminará inmediatamente sino después del período configurado.
      security:
        - BearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestAccountDeletionRequest'
      responses:
        '200':
          description: Solicitud de eliminación registrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountDeletionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/users/me/email:
    put:
      operationId: updateUserEmail
      tags:
        - Users
      summary: Actualizar email del usuario
      description: |
        Actualiza el email del usuario autenticado. Requiere verificación posterior.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEmailRequest'
      responses:
        '200':
          description: Email actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailUpdateResponse'
        '400':
          description: Email inválido o ya en uso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/users/me/deletion-request:
    get:
      operationId: getAccountDeletionStatus
      tags:
        - Users
      summary: Obtener estado de solicitud de eliminación
      description: |
        Consulta el estado de una solicitud de eliminación de cuenta pendiente.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Estado de la solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountDeletionStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
    delete:
      operationId: cancelAccountDeletion
      tags:
        - Users
      summary: Cancelar solicitud de eliminación
      description: |
        Cancela una solicitud de eliminación de cuenta pendiente.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Solicitud cancelada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountDeletionResponse'
        '400':
          description: No hay solicitud pendiente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/users/me/notifications/settings:
    get:
      operationId: getNotificationSettings
      tags:
        - Users
      summary: Obtener configuración de notificaciones
      description: |
        Devuelve las preferencias de notificaciones del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Configuración de notificaciones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettingsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
    put:
      operationId: updateNotificationSettings
      tags:
        - Users
      summary: Actualizar configuración de notificaciones
      description: |
        Actualiza las preferencias de notificaciones del usuario autenticado.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationSettingsRequest'
      responses:
        '200':
          description: Configuración actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettingsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/users/{userId}:
    get:
      operationId: getUserById
      tags:
        - Users
      summary: Obtener perfil de usuario por ID (admin)
      description: |
        Devuelve la información del perfil de un usuario específico. Solo para administradores.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
            minimum: 1
          description: ID del perfil de usuario
      responses:
        '200':
          description: Perfil del usuario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/{userId}/tokens:
    post:
      operationId: updateUserTokens
      tags:
        - Users
      summary: Actualizar tokens de un usuario (admin)
      description: |
        Incrementa o decrementa el balance de tokens de un usuario. Solo para administradores.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
            minimum: 1
          description: ID del perfil de usuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTokensRequest'
      responses:
        '200':
          description: Tokens actualizados exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokensUpdateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/me/tokens/balance:
    get:
      operationId: getMyTokenBalance
      tags:
        - Users
        - Tokens
      summary: Obtener balance de tokens del usuario autenticado
      description: |
        Obtiene el balance actual de tokens del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Balance de tokens obtenido exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_user_profile:
                    type: integer
                    example: 1
                  balance:
                    type: integer
                    example: 150
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/me/tokens/ledger:
    get:
      operationId: getMyTokenLedger
      tags:
        - Users
        - Tokens
      summary: Obtener historial de movimientos de tokens del usuario autenticado
      description: |
        Obtiene el historial paginado de movimientos de tokens del usuario autenticado.
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Número de página
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Cantidad de resultados por página
        - in: query
          name: from_date
          schema:
            type: string
            format: date-time
          description: Filtrar desde esta fecha
        - in: query
          name: to_date
          schema:
            type: string
            format: date-time
          description: Filtrar hasta esta fecha
        - in: query
          name: ref_type
          schema:
            type: string
          description: Filtrar por tipo de referencia
        - in: query
          name: sortBy
          schema:
            type: string
            default: created_at
          description: Campo por el cual ordenar
        - in: query
          name: order
          schema:
            type: string
            enum:
              - asc
              - desc
            default: desc
          description: Orden de los resultados
      responses:
        '200':
          description: Historial de tokens obtenido exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        id_ledger:
                          type: integer
                          example: 1
                        id_user_profile:
                          type: integer
                          example: 1
                        delta:
                          type: integer
                          example: 50
                        balance_after:
                          type: integer
                          example: 150
                        reason:
                          type: string
                          example: ACHIEVEMENT_UNLOCKED
                        ref_type:
                          type: string
                          nullable: true
                          example: achievement
                        ref_id:
                          type: integer
                          nullable: true
                          example: 5
                        metadata:
                          type: object
                          nullable: true
                        created_at:
                          type: string
                          format: date-time
                  page:
                    type: integer
                    example: 1
                  limit:
                    type: integer
                    example: 20
                  total:
                    type: integer
                    example: 45
                  totalPages:
                    type: integer
                    example: 3
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/me/tokens/stats:
    get:
      operationId: getMyTokenStats
      tags:
        - Users
        - Tokens
      summary: Obtener estadísticas de tokens del usuario autenticado
      description: |
        Obtiene estadísticas agregadas de tokens del usuario autenticado.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Estadísticas de tokens obtenidas exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  balance:
                    type: integer
                    example: 150
                  total_earned:
                    type: integer
                    example: 500
                  total_spent:
                    type: integer
                    example: 350
                  earned_this_month:
                    type: integer
                    example: 100
                  spent_this_month:
                    type: integer
                    example: 50
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/users/{userId}/subscription:
    put:
      operationId: updateUserSubscription
      tags:
        - Users
      summary: Actualizar suscripción de un usuario (admin)
      description: |
        Cambia el nivel de suscripción de un usuario. Solo para administradores.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
            minimum: 1
          description: ID del perfil de usuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSubscriptionRequest'
      responses:
        '200':
          description: Suscripción actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/workouts/sessions:
    post:
      operationId: startWorkoutSession
      tags:
        - Workouts
      summary: Iniciar sesión de entrenamiento
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StartWorkoutSessionRequest'
      responses:
        '201':
          description: Sesión iniciada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: Ya existe una sesión activa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workouts/sessions/active:
    get:
      operationId: getActiveWorkoutSession
      tags:
        - Workouts
      summary: Obtener sesión activa
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Sesión activa
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/workouts/sessions/me:
    get:
      operationId: listMyWorkoutSessions
      tags:
        - Workouts
      summary: Listar mis sesiones de entrenamiento
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: status
          in: query
          schema:
            type: string
            enum:
              - IN_PROGRESS
              - COMPLETED
              - CANCELLED
      responses:
        '200':
          description: Lista de sesiones
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/WorkoutSession'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/workouts/stats:
    get:
      operationId: getWorkoutStats
      tags:
        - Workouts
      summary: Obtener estadísticas de workout
      security:
        - BearerAuth: []
      parameters:
        - name: start_date
          in: query
          schema:
            type: string
            format: date
        - name: end_date
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Estadísticas de workout
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/WorkoutStats'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/workouts/sessions/{id}:
    get:
      operationId: getWorkoutSession
      tags:
        - Workouts
      summary: Obtener sesión por ID
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Sesión encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      operationId: updateWorkoutSession
      tags:
        - Workouts
      summary: Actualizar sesión (notas)
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkoutSessionRequest'
      responses:
        '200':
          description: Sesión actualizada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/workouts/sessions/{id}/complete:
    put:
      operationId: completeWorkoutSession
      tags:
        - Workouts
      summary: Completar sesión
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompleteWorkoutSessionRequest'
      responses:
        '200':
          description: Sesión completada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/workouts/sessions/{id}/cancel:
    put:
      operationId: cancelWorkoutSession
      tags:
        - Workouts
      summary: Cancelar sesión
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Sesión cancelada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/workouts/sessions/{id}/sets:
    get:
      operationId: listWorkoutSets
      tags:
        - Workouts
      summary: Listar sets de una sesión
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
        - name: id_exercise
          in: query
          schema:
            type: integer
          description: Filtrar por ejercicio
      responses:
        '200':
          description: Lista de sets
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/WorkoutSet'
        '400':
          $ref: '#/components/responses/BadRequest'
    post:
      operationId: registerWorkoutSet
      tags:
        - Workouts
      summary: Registrar un set
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterWorkoutSetRequest'
      responses:
        '201':
          description: Set registrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSet'
        '400':
          $ref: '#/components/responses/BadRequest'
  /api/workouts/sets/{id}:
    put:
      operationId: updateWorkoutSet
      tags:
        - Workouts
      summary: Actualizar un set
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkoutSetRequest'
      responses:
        '200':
          description: Set actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/WorkoutSet'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      operationId: deleteWorkoutSet
      tags:
        - Workouts
      summary: Eliminar un set
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Set eliminado
        '404':
          $ref: '#/components/responses/NotFound'
security:
  - bearerAuth: []
