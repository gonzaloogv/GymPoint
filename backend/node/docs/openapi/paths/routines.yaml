paths:
  /api/routines:
    post:
      operationId: createRoutineWithExercises
      tags:
        - Routines
      summary: Crear rutina con ejercicios
      description: Crea una rutina con al menos 2 ejercicios
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/routines.yaml#/components/schemas/CreateRoutineRequest'
      responses:
        '201':
          description: Rutina creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/RoutineWithDetails'
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
  /api/routines/me:
    get:
      operationId: getMyRoutines
      tags:
        - Routines
      summary: Obtener mis rutinas
      description: Lista las rutinas del usuario autenticado
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/PageParam'
        - $ref: '../components/parameters.yaml#/components/parameters/LimitParam'
      responses:
        '200':
          description: Lista de rutinas del usuario
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '../components/schemas/routines.yaml#/components/schemas/Routine'
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
  /api/routines/templates:
    get:
      operationId: listRoutineTemplates
      tags:
        - Routines
      summary: Listar plantillas de rutinas
      parameters:
        - name: difficulty
          in: query
          description: Filtrar por nivel de dificultad
          schema:
            type: string
            enum:
              - BEGINNER
              - INTERMEDIATE
              - ADVANCED
        - name: limit
          in: query
          description: Límite de resultados
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 5
      responses:
        '200':
          description: Lista de plantillas de rutinas
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '../components/schemas/routines.yaml#/components/schemas/Routine'
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
  /api/routines/{id}/import:
    post:
      operationId: importRoutineTemplate
      tags:
        - Routines
      summary: Importar una plantilla de rutina
      description: Crea una copia de la plantilla para el usuario autenticado
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID de la plantilla a importar
          schema:
            type: integer
      responses:
        '201':
          description: Rutina importada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  id_routine_copy:
                    type: integer
                    description: ID de la rutina copiada
                  routine:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/Routine'
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
  /api/routines/{id}:
    get:
      operationId: getRoutineById
      tags:
        - Routines
      summary: Obtener rutina por ID
      description: Obtiene rutina con ejercicios y días
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Rutina encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/RoutineWithDetails'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
    put:
      operationId: updateRoutine
      tags:
        - Routines
      summary: Actualizar rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/routines.yaml#/components/schemas/UpdateRoutineRequest'
      responses:
        '200':
          description: Rutina actualizada
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/Routine'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
    delete:
      operationId: deleteRoutine
      tags:
        - Routines
      summary: Eliminar rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Rutina eliminada
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
  /api/routines/{id}/exercises:
    post:
      operationId: addExerciseToRoutine
      tags:
        - Routines
      summary: Agregar ejercicio a rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/exercises.yaml#/components/schemas/AddExerciseToRoutineRequest'
      responses:
        '201':
          description: Ejercicio agregado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/exercises.yaml#/components/schemas/RoutineExercise'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
  /api/routines/{id}/exercises/{id_exercise}:
    put:
      operationId: updateRoutineExercise
      tags:
        - Routines
      summary: Actualizar ejercicio en rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
        - $ref: '../components/parameters.yaml#/components/parameters/ExerciseIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/exercises.yaml#/components/schemas/UpdateRoutineExerciseRequest'
      responses:
        '200':
          description: Ejercicio actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/exercises.yaml#/components/schemas/RoutineExercise'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
    delete:
      operationId: deleteRoutineExercise
      tags:
        - Routines
      summary: Eliminar ejercicio de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
        - $ref: '../components/parameters.yaml#/components/parameters/ExerciseIdPathParam'
      responses:
        '204':
          description: Ejercicio eliminado de rutina
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
  /api/routines/{id}/days:
    get:
      operationId: listRoutineDays
      tags:
        - Routines
      summary: Listar días de rutina
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Lista de días
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    type: array
                    items:
                      $ref: '../components/schemas/routines.yaml#/components/schemas/RoutineDay'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
    post:
      operationId: createRoutineDay
      tags:
        - Routines
      summary: Crear día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/routines.yaml#/components/schemas/CreateRoutineDayRequest'
      responses:
        '201':
          description: Día creado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/RoutineDay'
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
  /api/routines/days/{id_routine_day}:
    put:
      operationId: updateRoutineDay
      tags:
        - Routines
      summary: Actualizar día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/RoutineDayIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '../components/schemas/routines.yaml#/components/schemas/UpdateRoutineDayRequest'
      responses:
        '200':
          description: Día actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '../components/schemas/routines.yaml#/components/schemas/RoutineDay'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'
    delete:
      operationId: deleteRoutineDay
      tags:
        - Routines
      summary: Eliminar día de rutina
      security:
        - BearerAuth: []
      parameters:
        - $ref: '../components/parameters.yaml#/components/parameters/RoutineDayIdPathParam'
      responses:
        '204':
          description: Día eliminado
        '400':
          $ref: '../components/responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: '../components/responses.yaml#/components/responses/NotFound'