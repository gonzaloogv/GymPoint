components:
  schemas:
    UserProfileSummary:
      type: object
      required:
        - id_user_profile
        - name
        - lastname
        - subscription
      additionalProperties: false
      properties:
        id_user_profile:
          type: integer
        name:
          type: string
          example: Ana
        lastname:
          type: string
          example: Torres
        subscription:
          $ref: '../common.yaml#/components/schemas/SubscriptionType'
          description: Nivel actual de la app.
        premium_since:
          type:
            - string
            - 'null'
          format: date-time
        tokens_balance:
          type: integer
          minimum: 0
        tokens_lifetime:
          type: integer
          minimum: 0
        locality:
          type:
            - string
            - 'null'
        gender:
          oneOf:
            - $ref: '../common.yaml#/components/schemas/Gender'
            - type: 'null'
        birth_date:
          type:
            - string
            - 'null'
          format: date
    UserProfileResponse:
      type: object
      required:
        - id_user_profile
        - email
        - name
        - lastname
        - subscription
        - tokens
        - created_at
      additionalProperties: false
      properties:
        id_user_profile:
          type: integer
          description: ID único del perfil de usuario
          example: 42
        email:
          type: string
          format: email
          description: Email del usuario
          example: usuario@example.com
        name:
          type: string
          minLength: 2
          maxLength: 80
          description: Nombre del usuario
          example: Juan
        lastname:
          type: string
          minLength: 2
          maxLength: 80
          description: Apellido del usuario
          example: Pérez
        gender:
          oneOf:
            - $ref: '../common.yaml#/components/schemas/Gender'
            - type: 'null'
          description: Género del usuario
          example: M
        birth_date:
          oneOf:
            - type: string
              format: date
            - type: 'null'
          description: Fecha de nacimiento (YYYY-MM-DD)
          example: '1990-05-15'
        locality:
          oneOf:
            - type: string
            - type: 'null'
          description: Localidad del usuario
          example: Buenos Aires
        profile_picture_url:
          oneOf:
            - type: string
              format: uri
            - type: 'null'
          description: URL de la foto de perfil
        subscription:
          allOf:
            - $ref: '../common.yaml#/components/schemas/SubscriptionType'
          description: Nivel de suscripción actual
          example: FREE
        tokens:
          type: integer
          minimum: 0
          description: Balance actual de tokens
          example: 150
        preferred_language:
          type: string
          description: Idioma preferido (código ISO 639-1)
          example: es
        timezone:
          oneOf:
            - type: string
            - type: 'null'
          description: Zona horaria del usuario
          example: America/Argentina/Buenos_Aires
        onboarding_completed:
          type: boolean
          description: Indica si completó el onboarding
          example: true
        created_at:
          type: string
          format: date-time
          description: Fecha de creación del perfil
        updated_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de última actualización
    UpdateUserProfileRequest:
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 80
          description: Nombre del usuario
        lastname:
          type: string
          minLength: 2
          maxLength: 80
          description: Apellido del usuario
        gender:
          $ref: '../common.yaml#/components/schemas/Gender'
        birth_date:
          type: string
          format: date
          description: Fecha de nacimiento (YYYY-MM-DD)
          example: '1990-05-15'
        locality:
          type: string
          maxLength: 100
          description: Localidad del usuario
        profile_picture_url:
          type: string
          format: uri
          description: URL de la foto de perfil
        preferred_language:
          type: string
          pattern: ^[a-z]{2}$
          description: Idioma preferido (código ISO 639-1)
          example: es
        timezone:
          type: string
          description: Zona horaria del usuario
          example: America/Argentina/Buenos_Aires
        onboarding_completed:
          type: boolean
          description: Marca el onboarding como completado
    UserRoutine:
      type: object
      properties:
        id_user_routine:
          type: integer
        id_user:
          type: integer
        id_routine:
          type: integer
        start_date:
          type: string
          format: date-time
        finish_date:
          type: string
          format: date-time
        active:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        routine:
          $ref: 'routines.yaml#/components/schemas/RoutineWithDetails'
      required:
        - id_user_routine
        - id_user
        - id_routine
        - start_date
        - active
    UserRoutineCounts:
      type: object
      properties:
        total_owned:
          type: integer
        imported_count:
          type: integer
        created_count:
          type: integer
    UpdateEmailRequest:
      type: object
      required: [email]
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          description: Nuevo email del usuario
          example: nuevo@example.com
    EmailUpdateResponse:
      type: object
      required: [email, email_verified]
      additionalProperties: false
      properties:
        email:
          type: string
          format: email
          description: Email actualizado
        email_verified:
          type: boolean
          description: Estado de verificación del email
          example: false
        message:
          type: string
          description: Mensaje informativo
          example: Email actualizado. Por favor verifica tu nuevo email.
    RequestAccountDeletionRequest:
      type: object
      additionalProperties: false
      properties:
        reason:
          type: string
          maxLength: 500
          description: Razón de la eliminación (opcional)
          example: Ya no uso la aplicación
    AccountDeletionResponse:
      type: object
      required: [status, scheduled_deletion_date]
      additionalProperties: false
      properties:
        id_account_deletion_request:
          type: integer
          description: ID de la solicitud de eliminación
        id_account:
          type: integer
          description: ID de la cuenta
        status:
          type: string
          enum: [PENDING, CANCELLED, COMPLETED]
          description: Estado de la solicitud
          example: PENDING
        reason:
          oneOf:
            - type: string
            - type: 'null'
          description: Razón proporcionada por el usuario
        scheduled_deletion_date:
          type: string
          format: date-time
          description: Fecha programada para eliminación
        cancelled_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de cancelación (si aplica)
        metadata:
          type: object
          description: Metadatos adicionales de la solicitud
          properties:
            grace_period_days:
              type: integer
              description: Días de período de gracia
              example: 30
    AccountDeletionStatusResponse:
      type: object
      required: [has_active_request]
      additionalProperties: false
      properties:
        has_active_request:
          type: boolean
          description: Indica si hay una solicitud activa
          example: true
        request:
          oneOf:
            - $ref: '#/components/schemas/AccountDeletionResponse'
            - type: 'null'
          description: Detalles de la solicitud (si existe)
    NotificationSettingsResponse:
      type: object
      required:
        - id_user_notification_setting
        - id_user_profile
        - push_enabled
        - email_enabled
      additionalProperties: false
      properties:
        id_user_notification_setting:
          type: integer
          description: ID único de la configuración
        id_user_profile:
          type: integer
          description: ID del perfil de usuario
        push_enabled:
          type: boolean
          description: Notificaciones push habilitadas
          example: true
        email_enabled:
          type: boolean
          description: Notificaciones por email habilitadas
          example: true
        reminder_enabled:
          type: boolean
          description: Recordatorios habilitados
          example: true
        achievement_enabled:
          type: boolean
          description: Notificaciones de logros habilitadas
          example: true
        reward_enabled:
          type: boolean
          description: Notificaciones de recompensas habilitadas
          example: true
        gym_news_enabled:
          type: boolean
          description: Novedades de gimnasios habilitadas
          example: false
        quiet_hours_start:
          oneOf:
            - type: string
              pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
            - type: 'null'
          description: Inicio de horario silencioso (HH:MM)
          example: '22:00'
        quiet_hours_end:
          oneOf:
            - type: string
              pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
            - type: 'null'
          description: Fin de horario silencioso (HH:MM)
          example: '08:00'
        created_at:
          type: string
          format: date-time
          description: Fecha de creación
        updated_at:
          oneOf:
            - type: string
              format: date-time
            - type: 'null'
          description: Fecha de última actualización
    UpdateNotificationSettingsRequest:
      type: object
      additionalProperties: false
      properties:
        push_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones push
        email_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones por email
        reminder_enabled:
          type: boolean
          description: Habilitar/deshabilitar recordatorios
        achievement_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones de logros
        reward_enabled:
          type: boolean
          description: Habilitar/deshabilitar notificaciones de recompensas
        gym_news_enabled:
          type: boolean
          description: Habilitar/deshabilitar novedades de gimnasios
        quiet_hours_start:
          type: string
          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
          description: Inicio de horario silencioso (HH:MM)
          example: '22:00'
        quiet_hours_end:
          type: string
          pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
          description: Fin de horario silencioso (HH:MM)
          example: '08:00'
    UpdateSubscriptionRequest:
      type: object
      required: [subscription]
      additionalProperties: false
      properties:
        subscription:
          type: string
          enum: [FREE, PREMIUM]
          description: Nuevo nivel de suscripción
          example: PREMIUM